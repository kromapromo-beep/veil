<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>KROMA — Enter the Signal</title>

<!-- Open Graph / Link Preview -->
<meta property="og:type" content="website">
<meta property="og:title" content="KROMA — Enter the Signal">
<meta property="og:description" content="Vision · Sound · World — Enter the dystopian universe of Smilemore.">
<meta property="og:image" content="https://iamkroma.com/gallery-1.png">
<meta property="og:url" content="https://iamkroma.com">

<!-- Twitter Card -->
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="KROMA — Enter the Signal">
<meta name="twitter:description" content="Vision · Sound · World — Enter the dystopian universe of Smilemore.">
<meta name="twitter:image" content="https://iamkroma.com/gallery-1.png">

<!-- General -->
<meta name="description" content="Vision · Sound · World — Enter the dystopian universe of Smilemore.">
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;500;600;700;800;900&family=Rajdhani:wght@300;400;500;600;700&family=Space+Mono:wght@400;700&display=swap" rel="stylesheet">
<style>
*, *::before, *::after { margin:0; padding:0; box-sizing:border-box; }

:root {
  --black: #000000;
  --white: #f0f0f0;
  --white-pure: #ffffff;
  --gray-dark: #0a0a0a;
  --gray-mid: #1a1a1a;
  --gray-light: #2a2a2a;
  --gray-text: #666;
  --accent-red: #ff1a1a;
  --accent-blue: #00a2ff;
  --accent-green: #00e86e;
  --accent-yellow: #ffd600;
  --accent-cyan: #00f0ff;
  --accent-magenta: #ff00aa;
  --grain-opacity: 0.035;
  --transition-smooth: cubic-bezier(0.16, 1, 0.3, 1);
  --transition-cinematic: cubic-bezier(0.65, 0, 0.35, 1);
}

html { scroll-behavior: smooth; overflow-x: hidden; }

body {
  background: var(--black);
  color: var(--white);
  font-family: 'Rajdhani', sans-serif;
  overflow-x: hidden;
  cursor: default;
  -webkit-font-smoothing: antialiased;
}

/* Film Grain */
.film-grain {
  position: fixed; top:-50%; left:-50%;
  width: 200%; height: 200%;
  z-index: 10000; pointer-events: none;
  opacity: var(--grain-opacity);
  background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)'/%3E%3C/svg%3E");
  animation: grain 0.5s steps(6) infinite;
}
@keyframes grain {
  0%,100%{transform:translate(0,0)}10%{transform:translate(-5%,-10%)}30%{transform:translate(7%,-25%)}50%{transform:translate(-15%,10%)}70%{transform:translate(0%,15%)}90%{transform:translate(-10%,10%)}
}

.vignette {
  position:fixed;top:0;left:0;width:100%;height:100%;z-index:9999;pointer-events:none;
  background:radial-gradient(ellipse at center,transparent 50%,rgba(0,0,0,0.7) 100%);
}

.scanlines {
  position:fixed;top:0;left:0;width:100%;height:100%;z-index:9998;pointer-events:none;
  background:repeating-linear-gradient(0deg,transparent,transparent 2px,rgba(0,0,0,0.03) 2px,rgba(0,0,0,0.03) 4px);
}

/* Particles */
.particles-container {
  position:fixed;top:0;left:0;width:100%;height:100%;z-index:1;pointer-events:none;overflow:hidden;
}
.particle {
  position:absolute;width:2px;height:2px;background:rgba(255,255,255,0.15);border-radius:50%;
  animation:particleFloat linear infinite;
}
@keyframes particleFloat {
  0%{transform:translateY(100vh) translateX(0);opacity:0}10%{opacity:1}90%{opacity:1}100%{transform:translateY(-10vh) translateX(40px);opacity:0}
}

/* ═══ NAVIGATION ═══ */
.nav {
  position:fixed;top:0;left:0;width:100%;z-index:9990;
  padding:24px 48px;display:flex;align-items:center;justify-content:center;
  transition:all 0.6s var(--transition-smooth);background:transparent;
}
.nav.scrolled {
  background:rgba(0,0,0,0.88);backdrop-filter:blur(20px);-webkit-backdrop-filter:blur(20px);
  padding:16px 48px;border-bottom:1px solid rgba(255,255,255,0.04);
}

.nav-links {
  display:flex;gap:48px;list-style:none;align-items:center;
}

.nav-link {
  font-family:'Orbitron',sans-serif;font-size:0.6rem;font-weight:500;
  letter-spacing:0.3em;text-transform:uppercase;color:var(--gray-text);
  text-decoration:none;cursor:pointer;transition:color 0.4s ease;
  position:relative;display:flex;align-items:center;gap:10px;
}

.nav-dot {
  width:7px;height:7px;border-radius:50%;border:1px solid currentColor;
  transition:all 0.4s var(--transition-smooth);opacity:0.4;
}

.nav-link:hover { color:var(--white-pure); }
.nav-link:hover .nav-dot { opacity:0.7; }

.nav-link.active { color:var(--white-pure); }
.nav-link.active .nav-dot { opacity:1; transform:scale(1.3); }

.nav-link[data-section="landing"] .nav-dot { background:var(--accent-red);border-color:var(--accent-red);box-shadow:0 0 8px var(--accent-red); }
.nav-link[data-section="music"] .nav-dot { background:var(--accent-blue);border-color:var(--accent-blue);box-shadow:0 0 8px var(--accent-blue); }
.nav-link[data-section="store"] .nav-dot { background:var(--accent-green);border-color:var(--accent-green);box-shadow:0 0 8px var(--accent-green); }
.nav-link[data-section="story"] .nav-dot { background:var(--accent-yellow);border-color:var(--accent-yellow);box-shadow:0 0 8px var(--accent-yellow); }
.nav-link[data-section="luxnox"] .nav-dot.luxnox-dot {
  background:transparent;
  border-color:rgba(255,255,255,0.45);border-width:1.5px;
  box-shadow:0 0 6px rgba(255,255,255,0.15);
}

.nav-link.active[data-section="landing"] .nav-dot { box-shadow:0 0 14px var(--accent-red),0 0 30px rgba(255,26,26,0.3); }
.nav-link.active[data-section="music"] .nav-dot { box-shadow:0 0 14px var(--accent-blue),0 0 30px rgba(0,162,255,0.3); }
.nav-link.active[data-section="store"] .nav-dot { box-shadow:0 0 14px var(--accent-green),0 0 30px rgba(0,232,110,0.3); }
.nav-link.active[data-section="story"] .nav-dot { box-shadow:0 0 14px var(--accent-yellow),0 0 30px rgba(255,214,0,0.3); }
.nav-link.active[data-section="luxnox"] .nav-dot.luxnox-dot {
  border-color:rgba(255,255,255,0.8);
  box-shadow:0 0 14px rgba(255,255,255,0.5),0 0 30px rgba(255,255,255,0.2);
}

/* Audio Toggle */
.audio-toggle {
  position:fixed;bottom:32px;right:32px;z-index:9991;
  width:44px;height:44px;border:1px solid rgba(255,255,255,0.12);border-radius:50%;
  background:rgba(0,0,0,0.6);backdrop-filter:blur(10px);cursor:pointer;
  display:flex;align-items:center;justify-content:center;gap:2px;
  transition:all 0.4s ease;
}
.audio-toggle:hover {
  border-color:var(--accent-cyan);box-shadow:0 0 20px rgba(0,240,255,0.15);
}
.audio-bar {
  width:2px;background:var(--white);border-radius:1px;transition:height 0.15s ease;
}
.audio-toggle.muted .audio-bar { height:2px !important; }
.audio-label {
  position:absolute;right:56px;top:50%;transform:translateY(-50%);
  font-family:'Space Mono',monospace;font-size:0.5rem;letter-spacing:0.2em;
  text-transform:uppercase;color:rgba(255,255,255,0.25);white-space:nowrap;
  opacity:0;transition:opacity 0.3s ease;pointer-events:none;
}
.audio-toggle:hover .audio-label { opacity:1; }

/* ═══ SECTIONS ═══ */
.section {
  display:none;min-height:100vh;position:relative;z-index:2;
}
.section.active {
  display:block;animation:sectionEnter 0.8s var(--transition-cinematic) forwards;
}
@keyframes sectionEnter {
  0%{opacity:0}100%{opacity:1}
}

/* ═══ HERO / LANDING ═══ */
.hero {
  min-height:100vh;display:flex;align-items:center;justify-content:center;
  position:relative;overflow:hidden;width:100%;
}
.hero-bg {
  position:absolute;top:0;left:0;width:100%;height:100%;
  background:radial-gradient(ellipse at 30% 50%,rgba(255,26,26,0.04) 0%,transparent 60%),
              radial-gradient(ellipse at 70% 50%,rgba(0,240,255,0.02) 0%,transparent 60%);
}
.hero-grid {
  position:absolute;top:0;left:0;width:100%;height:100%;
  background-image:linear-gradient(rgba(255,255,255,0.015) 1px,transparent 1px),linear-gradient(90deg,rgba(255,255,255,0.015) 1px,transparent 1px);
  background-size:80px 80px;animation:gridPulse 8s ease-in-out infinite;
}
@keyframes gridPulse { 0%,100%{opacity:0.3}50%{opacity:0.6} }

.hero-content { text-align:center;z-index:3;position:relative;width:100%; }
.hero-title-text {
  font-family:'Orbitron',sans-serif;
  font-size:clamp(4rem,14vw,13rem);
  font-weight:900;
  letter-spacing:0.12em;
  line-height:0.9;
  color:var(--white-pure);
  text-shadow:0 0 80px rgba(255,255,255,0.06);
  margin-bottom:20px;
  opacity:0;
  animation:heroTitleIn 2.5s var(--transition-cinematic) 0.3s forwards;
}

@keyframes heroTitleIn {
  0% { opacity:0; transform:translateY(40px); letter-spacing:0.4em; filter:blur(10px); }
  60% { filter:blur(0); }
  100% { opacity:1; transform:translateY(0); letter-spacing:0.12em; filter:blur(0); }
}









.hero-eyebrow {
  font-family:'Space Mono',monospace;font-size:0.6rem;letter-spacing:0.6em;
  text-transform:uppercase;color:var(--gray-text);margin-bottom:40px;
  opacity:0;animation:heroReveal 1.5s var(--transition-smooth) 0.2s forwards;
}

.hero-subtitle {
  font-family:'Rajdhani',sans-serif;font-size:1rem;font-weight:300;
  letter-spacing:0.4em;text-transform:uppercase;color:rgba(255,255,255,0.3);
  margin-top:20px;opacity:0;
  animation:heroReveal 1.5s var(--transition-smooth) 1.2s forwards;
}

.hero-divider {
  width:60px;height:1px;background:linear-gradient(90deg,transparent,var(--white),transparent);
  margin:40px auto;opacity:0;
  animation:heroReveal 1.5s var(--transition-smooth) 1.6s forwards;
}

.hero-tagline {
  font-family:'Space Mono',monospace;font-size:0.65rem;letter-spacing:0.2em;
  color:rgba(255,255,255,0.18);opacity:0;
  animation:heroReveal 1.5s var(--transition-smooth) 1.8s forwards;
}

@keyframes heroReveal {
  0%{opacity:0;transform:translateY(20px)}100%{opacity:1;transform:translateY(0)}
}

/* Social Links */
.social-links {
  position:fixed;right:48px;top:50%;transform:translateY(-50%);z-index:100;
  display:flex;flex-direction:column;gap:22px;
}
.social-link {
  width:38px;height:38px;border:1px solid rgba(255,255,255,0.07);border-radius:50%;
  display:flex;align-items:center;justify-content:center;text-decoration:none;
  color:rgba(255,255,255,0.25);transition:all 0.5s var(--transition-smooth);
  position:relative;overflow:hidden;
}
.social-link::before {
  content:'';position:absolute;top:50%;left:50%;width:0;height:0;
  background:var(--accent-red);border-radius:50%;transform:translate(-50%,-50%);
  transition:all 0.5s var(--transition-smooth);opacity:0.15;
}
.social-link:hover {
  border-color:var(--accent-red);color:var(--white-pure);transform:scale(1.1);
  box-shadow:0 0 20px rgba(255,26,26,0.2);
}
.social-link:hover::before { width:100%;height:100%; }
.social-link svg { width:15px;height:15px;position:relative;z-index:1;fill:currentColor; }

/* Scroll Indicator */
.scroll-indicator {
  position:absolute;bottom:40px;left:0;right:0;
  width:100%;display:flex;flex-direction:column;align-items:center;gap:10px;
  opacity:0;animation:heroReveal 1.5s var(--transition-smooth) 2.2s forwards;
}
.scroll-indicator span {
  font-family:'Space Mono',monospace;font-size:0.5rem;letter-spacing:0.3em;
  text-transform:uppercase;color:rgba(255,255,255,0.15);
}
.scroll-line {
  width:1px;height:36px;position:relative;overflow:hidden;background:rgba(255,255,255,0.05);
}
.scroll-line::after {
  content:'';position:absolute;top:-100%;left:0;width:100%;height:100%;
  background:var(--white);animation:scrollDown 2s ease-in-out infinite;
}
@keyframes scrollDown { 0%{top:-100%}50%{top:100%}100%{top:100%} }

/* ═══ ABOUT (within landing) ═══ */
.about-section {
  padding:160px 48px;max-width:1200px;margin:0 auto;position:relative;
}
.section-label {
  font-family:'Space Mono',monospace;font-size:0.55rem;letter-spacing:0.5em;
  text-transform:uppercase;color:var(--accent-red);margin-bottom:36px;
  display:flex;align-items:center;gap:14px;
}
.store-label::before, .music-label::before { display:none; }
.section-label::before {
  content:'';width:28px;height:1px;background:var(--accent-red);
  box-shadow:0 0 8px rgba(255,26,26,0.5);
}
.about-heading {
  font-family:'Orbitron',sans-serif;font-size:clamp(1.8rem,4vw,3.2rem);font-weight:700;
  letter-spacing:0.05em;line-height:1.25;color:var(--white-pure);
  max-width:700px;margin-bottom:44px;
}
.about-text {
  font-family:'Rajdhani',sans-serif;font-size:1.05rem;font-weight:300;
  line-height:2;color:rgba(255,255,255,0.35);max-width:600px;letter-spacing:0.02em;
}
.about-text strong { color:var(--white);font-weight:500; }

.stats-row {
  display:flex;gap:80px;margin-top:80px;padding-top:60px;
  border-top:1px solid rgba(255,255,255,0.04);
}
.stat-item { text-align:left; }
.stat-number {
  font-family:'Orbitron',sans-serif;font-size:2.5rem;font-weight:800;
  color:var(--white-pure);line-height:1;
}
.stat-number .stat-accent {
  color:var(--accent-red);text-shadow:0 0 20px rgba(255,26,26,0.4);
}
.stat-label {
  font-family:'Space Mono',monospace;font-size:0.55rem;letter-spacing:0.3em;
  text-transform:uppercase;color:rgba(255,255,255,0.2);margin-top:12px;
}


/* Welcome to Smilemore CTA */
.welcome-smilemore {
  font-family:'Orbitron',sans-serif;font-size:clamp(1.2rem,3vw,2.2rem);font-weight:900;
  letter-spacing:0.2em;text-transform:uppercase;color:var(--white-pure);
  margin-top:80px;padding-top:60px;
  border-top:1px solid rgba(255,255,255,0.04);
  text-shadow:0 0 40px rgba(255,255,255,0.08);
  text-align:center;
}

/* Social Links Row */
.social-row {
  display:flex;align-items:center;justify-content:center;gap:20px;
  margin-top:60px;flex-wrap:wrap;
}
.social-row-link {
  display:flex;align-items:center;gap:10px;text-decoration:none;
  padding:12px 22px;border:1px solid rgba(255,255,255,0.06);
  transition:all 0.5s var(--transition-smooth);position:relative;overflow:hidden;
}
.social-row-link::before {
  content:'';position:absolute;top:0;left:-100%;width:100%;height:100%;
  background:linear-gradient(90deg,transparent,rgba(255,255,255,0.04),transparent);
  transition:left 0.6s ease;
}
.social-row-link:hover::before { left:100%; }
.social-row-link:hover {
  border-color:rgba(255,255,255,0.2);
  box-shadow:0 0 30px rgba(255,255,255,0.05);
  transform:translateY(-2px);
}
.social-row-link svg {
  width:18px;height:18px;fill:rgba(255,255,255,0.35);
  transition:fill 0.4s ease;
}
.social-row-link:hover svg { fill:var(--white-pure); }
.social-row-link span {
  font-family:'Orbitron',sans-serif;font-size:0.6rem;font-weight:500;
  letter-spacing:0.25em;text-transform:uppercase;color:rgba(255,255,255,0.35);
  transition:color 0.4s ease;
}
.social-row-link:hover span { color:var(--white-pure); }


/* ═══ TOUR DATES ═══ */
.tour-section {
  margin-top:120px;padding-top:80px;
  border-top:1px solid rgba(255,255,255,0.03);
}
.tour-header { text-align:center;margin-bottom:50px; }
.tour-title {
  font-family:'Orbitron',sans-serif;font-size:clamp(1.5rem,3.5vw,2.5rem);font-weight:900;
  letter-spacing:0.2em;color:var(--white-pure);margin-top:8px;
}

.tour-empty {
  text-align:center;padding:60px 20px;
  border:1px solid rgba(255,255,255,0.03);
  background:rgba(255,255,255,0.01);
}
.tour-empty-icon {
  margin-bottom:24px;
}
.tour-empty-icon svg {
  width:40px;height:40px;color:rgba(255,255,255,0.08);
}
.tour-empty-text {
  font-family:'Orbitron',sans-serif;font-size:0.8rem;font-weight:700;
  letter-spacing:0.3em;color:rgba(255,255,255,0.15);margin-bottom:12px;
}
.tour-empty-sub {
  font-family:'Rajdhani',sans-serif;font-size:0.9rem;font-weight:300;
  color:rgba(255,255,255,0.1);letter-spacing:0.1em;
}
.tour-notify {
  display:inline-flex;align-items:center;gap:10px;
  margin-top:30px;padding:12px 28px;
  border:1px solid rgba(255,26,26,0.1);
}
.tour-notify-dot {
  width:6px;height:6px;border-radius:50%;background:var(--accent-red);
  animation:tourPulse 2s ease-in-out infinite;
}
@keyframes tourPulse {
  0%,100% { opacity:0.3;box-shadow:0 0 4px rgba(255,26,26,0.2); }
  50% { opacity:1;box-shadow:0 0 12px rgba(255,26,26,0.5); }
}
.tour-notify span {
  font-family:'Space Mono',monospace;font-size:0.5rem;
  letter-spacing:0.25em;text-transform:uppercase;color:rgba(255,255,255,0.2);
}

/* ═══ STORY / LORE ═══ */
.story-section { position:relative; }

.story-welcome {
  min-height:100vh;display:flex;flex-direction:column;align-items:center;
  justify-content:center;text-align:center;position:relative;
}
.story-welcome-text {
  font-family:'Orbitron',sans-serif;font-size:clamp(1rem,2.5vw,1.8rem);font-weight:400;
  letter-spacing:0.5em;color:var(--white-pure);opacity:0;
  animation:storyReveal 3s var(--transition-smooth) 0.5s forwards;
}
.story-welcome-title {
  font-family:'Orbitron',sans-serif;font-size:clamp(3rem,8vw,7rem);font-weight:900;
  letter-spacing:0.1em;color:var(--white-pure);margin-top:10px;
  text-shadow:0 0 60px rgba(255,214,0,0.15);opacity:0;
  animation:storyReveal 3s var(--transition-smooth) 1s forwards;
}
.story-divider-glow {
  width:200px;height:1px;margin:50px auto;
  background:linear-gradient(90deg,transparent,var(--accent-yellow),transparent);
  box-shadow:0 0 20px rgba(255,214,0,0.3);opacity:0;
  animation:storyReveal 2s var(--transition-smooth) 1.8s forwards;
}
@keyframes storyReveal {
  0%{opacity:0;transform:translateY(30px);filter:blur(8px)}
  100%{opacity:1;transform:translateY(0);filter:blur(0)}
}

.lore-content { padding:0 48px 160px;max-width:1000px;margin:0 auto; }
.lore-block {
  margin-bottom:120px;position:relative;opacity:0;transform:translateY(40px);
  transition:all 1s var(--transition-smooth);
}
.lore-block.visible { opacity:1;transform:translateY(0); }
.lore-chapter {
  font-family:'Space Mono',monospace;font-size:0.55rem;letter-spacing:0.5em;
  text-transform:uppercase;color:var(--accent-yellow);margin-bottom:22px;
  text-shadow:0 0 10px rgba(255,214,0,0.3);
}
.lore-heading {
  font-family:'Orbitron',sans-serif;font-size:clamp(1.4rem,2.8vw,2.3rem);font-weight:700;
  letter-spacing:0.05em;color:var(--white-pure);margin-bottom:28px;line-height:1.3;
}
.lore-text {
  font-family:'Rajdhani',sans-serif;font-size:1rem;font-weight:300;line-height:2.2;
  color:rgba(255,255,255,0.35);letter-spacing:0.02em;
}

.lore-gallery {
  display:grid;grid-template-columns:repeat(2,1fr);gap:18px;margin-top:50px;
}
.lore-image-slot {
  aspect-ratio:16/10;border:1px solid rgba(255,255,255,0.05);background:var(--gray-dark);
  position:relative;overflow:hidden;cursor:pointer;transition:all 0.6s var(--transition-smooth);
}
.lore-image-slot:hover {
  border-color:rgba(255,255,255,0.12);box-shadow:0 0 40px rgba(0,0,0,0.5);
}
.lore-image-slot::after {
  content:'';position:absolute;top:0;left:0;width:100%;height:100%;
  background:linear-gradient(180deg,transparent 60%,rgba(0,0,0,0.8));pointer-events:none;
}
.lore-image-placeholder {
  width:100%;height:100%;display:flex;align-items:center;justify-content:center;
  flex-direction:column;gap:10px;
}
.lore-image-placeholder svg { width:28px;height:28px;color:rgba(255,255,255,0.06); }
.lore-image-placeholder span {
  font-family:'Space Mono',monospace;font-size:0.5rem;letter-spacing:0.3em;
  text-transform:uppercase;color:rgba(255,255,255,0.08);
}


.lore-welcome-final {
  font-family:'Orbitron',sans-serif;font-size:clamp(1.4rem,3vw,2.5rem);font-weight:700;
  letter-spacing:0.25em;color:var(--white-pure);
  text-shadow:0 0 40px rgba(255,214,0,0.12);
  padding:40px 0;
}
.lore-text strong { color:var(--white);font-weight:500; }


/* ═══ MUSIC TAB — CLASSIFIED ACCESS ═══ */
.music-section { padding:140px 48px 80px;max-width:900px;margin:0 auto; }
.music-header { text-align:center;margin-bottom:70px; }
.music-title {
  font-family:'Orbitron',sans-serif;font-size:clamp(2rem,5vw,4rem);font-weight:900;
  letter-spacing:0.15em;color:var(--white-pure);margin-top:8px;
}
.music-subtitle {
  font-family:'Rajdhani',sans-serif;font-size:1rem;font-weight:300;
  letter-spacing:0.3em;text-transform:uppercase;color:rgba(255,255,255,0.2);margin-top:18px;
}

.cl-track-list { display:flex;flex-direction:column;gap:16px; }

/* Track card */
.cl-track {
  position:relative;display:flex;align-items:center;gap:24px;
  padding:28px 32px;background:rgba(255,255,255,0.015);
  border:1px solid rgba(255,255,255,0.04);overflow:hidden;
  transition:all 0.5s ease;
}
.cl-track:hover { border-color:rgba(0,162,255,0.12); }
.cl-track.playing { border-color:rgba(0,162,255,0.25);box-shadow:0 0 40px rgba(0,162,255,0.06); }
.cl-track::before {
  content:'';position:absolute;top:0;left:0;width:3px;height:100%;
  background:var(--accent-blue);opacity:0.3;transition:opacity 0.4s ease;
}
.cl-track.playing::before { opacity:1; }
.cl-track.locked::before { background:var(--accent-red);opacity:0.15; }
/* Hide info on locked tracks until unlocked */
.cl-track.locked .cl-info { opacity:0;pointer-events:none; }
.cl-track.locked .cl-play { opacity:0;pointer-events:none; }
.cl-track.locked .cl-track-num { opacity:0; }


.cl-track-num {
  font-family:'Orbitron',sans-serif;font-size:3rem;font-weight:900;
  color:rgba(255,255,255,0.025);position:absolute;top:14px;right:24px;
  pointer-events:none;letter-spacing:0.05em;
}

/* Play button */
.cl-play {
  width:58px;height:58px;min-width:58px;border-radius:50%;
  display:flex;align-items:center;justify-content:center;
  cursor:pointer;position:relative;z-index:2;
}
.cl-play svg { width:18px;height:18px;color:var(--white-pure);position:relative;z-index:2; }
.cl-play .cl-play-icon { margin-left:2px; }
.cl-play .cl-pause-icon { display:none; }
.cl-track.playing .cl-play .cl-play-icon { display:none; }
.cl-track.playing .cl-play .cl-pause-icon { display:block; }

.cl-play-ring {
  position:absolute;top:0;left:0;width:100%;height:100%;border-radius:50%;
  border:1.5px solid rgba(255,255,255,0.1);transition:all 0.5s ease;
}
.cl-track:hover .cl-play-ring { border-color:rgba(0,162,255,0.3); }
.cl-track.playing .cl-play-ring {
  border-color:var(--accent-blue);
  box-shadow:0 0 20px rgba(0,162,255,0.15);
  animation:clPulse 2s ease-in-out infinite;
}
@keyframes clPulse {
  0%,100%{box-shadow:0 0 15px rgba(0,162,255,0.12)}
  50%{box-shadow:0 0 30px rgba(0,162,255,0.25)}
}

/* Track info */
.cl-info { flex:1;min-width:0;z-index:2; }
.cl-title {
  font-family:'Orbitron',sans-serif;font-size:1rem;font-weight:700;
  letter-spacing:0.1em;color:var(--white-pure);margin-bottom:3px;
}
.cl-sub {
  font-family:'Space Mono',monospace;font-size:0.5rem;
  letter-spacing:0.3em;text-transform:uppercase;color:rgba(255,255,255,0.2);
}
.cl-free-tag {
  display:inline-block;padding:2px 8px;margin-left:10px;
  font-family:'Orbitron',sans-serif;font-size:0.4rem;letter-spacing:0.2em;
  color:var(--accent-green);border:1px solid rgba(0,232,110,0.2);
  vertical-align:middle;
}

/* Scrubber / progress */
.cl-scrubber {
  width:100%;height:4px;background:rgba(255,255,255,0.05);
  margin-top:16px;border-radius:2px;cursor:pointer;position:relative;
}
.cl-scrubber-fill {
  height:100%;width:0%;background:var(--accent-blue);border-radius:2px;
  position:relative;transition:none;
}
.cl-scrubber-head {
  position:absolute;right:-6px;top:-4px;width:12px;height:12px;
  background:var(--white-pure);border-radius:50%;opacity:0;
  box-shadow:0 0 8px rgba(0,162,255,0.4);transition:opacity 0.2s ease;
}
.cl-track:hover .cl-scrubber-head,
.cl-track.playing .cl-scrubber-head { opacity:1; }

.cl-time {
  font-family:'Space Mono',monospace;font-size:0.45rem;
  letter-spacing:0.15em;color:rgba(255,255,255,0.15);margin-top:8px;
  display:flex;justify-content:space-between;
}

/* ═══ CLASSIFIED OVERLAY ═══ */
.cl-overlay {
  position:absolute;top:0;left:0;width:100%;height:100%;z-index:5;
  background:rgba(0,0,0,0.97);
  display:flex;align-items:center;justify-content:center;
  transition:all 0.6s ease;
}
.cl-overlay.unlocked {
  opacity:0;pointer-events:none;
}

.cl-stamp {
  display:flex;flex-direction:column;align-items:center;gap:12px;
}
.cl-stamp-text {
  font-family:'Orbitron',sans-serif;font-size:clamp(0.7rem,2vw,1.1rem);font-weight:900;
  letter-spacing:0.4em;color:var(--accent-red);
  text-shadow:0 0 20px rgba(255,26,26,0.3);
  border:2px solid rgba(255,26,26,0.2);padding:6px 24px;
  animation:clStampFlicker 4s ease-in-out infinite;
}
@keyframes clStampFlicker {
  0%,90%,100%{opacity:1} 92%{opacity:0.4} 94%{opacity:1} 96%{opacity:0.6}
}

.cl-unlock-btn {
  font-family:'Space Mono',monospace;font-size:0.5rem;letter-spacing:0.3em;
  text-transform:uppercase;color:rgba(255,255,255,0.3);
  background:none;border:1px solid rgba(255,255,255,0.08);
  padding:8px 20px;cursor:pointer;transition:all 0.4s ease;
}
.cl-unlock-btn:hover {
  color:var(--white-pure);border-color:rgba(255,26,26,0.3);
  box-shadow:0 0 20px rgba(255,26,26,0.08);
}

/* ═══ CODE MODAL ═══ */
.cl-modal-bg {
  position:fixed;top:0;left:0;width:100%;height:100%;z-index:99999;
  background:rgba(0,0,0,0.9);backdrop-filter:blur(12px);
  display:none;align-items:center;justify-content:center;
}
.cl-modal-bg.open { display:flex; }
.cl-modal {
  max-width:400px;width:90%;padding:48px 40px;text-align:center;
  border:1px solid rgba(255,26,26,0.1);background:rgba(10,10,10,0.95);
  position:relative;
}
.cl-modal-close {
  position:absolute;top:16px;right:20px;background:none;border:none;
  color:rgba(255,255,255,0.2);font-size:1.2rem;cursor:pointer;
  transition:color 0.3s ease;
}
.cl-modal-close:hover { color:var(--white-pure); }
.cl-modal-label {
  font-family:'Space Mono',monospace;font-size:0.5rem;
  letter-spacing:0.5em;text-transform:uppercase;color:var(--accent-red);
  margin-bottom:8px;
}
.cl-modal-title {
  font-family:'Orbitron',sans-serif;font-size:1.2rem;font-weight:900;
  letter-spacing:0.15em;color:var(--white-pure);margin-bottom:6px;
}
.cl-modal-track-name {
  font-family:'Space Mono',monospace;font-size:0.5rem;letter-spacing:0.3em;
  color:rgba(255,255,255,0.2);margin-bottom:30px;
}
.cl-code-input {
  width:100%;padding:14px 18px;background:rgba(255,255,255,0.03);
  border:1px solid rgba(255,255,255,0.08);color:var(--white-pure);
  font-family:'Orbitron',sans-serif;font-size:0.9rem;letter-spacing:0.3em;
  text-align:center;text-transform:uppercase;outline:none;
  transition:border-color 0.4s ease;
}
.cl-code-input::placeholder {
  color:rgba(255,255,255,0.1);letter-spacing:0.5em;font-size:0.6rem;
}
.cl-code-input:focus { border-color:rgba(255,26,26,0.3); }
.cl-code-input.denied {
  border-color:var(--accent-red);animation:clShake 0.5s ease;
}
.cl-code-input.granted {
  border-color:var(--accent-green);
}
@keyframes clShake {
  0%,100%{transform:translateX(0)} 20%{transform:translateX(-8px)}
  40%{transform:translateX(8px)} 60%{transform:translateX(-5px)}
  80%{transform:translateX(5px)}
}
.cl-submit-btn {
  width:100%;margin-top:16px;padding:14px;background:none;
  border:1px solid rgba(255,26,26,0.15);color:rgba(255,255,255,0.4);
  font-family:'Orbitron',sans-serif;font-size:0.6rem;letter-spacing:0.3em;
  text-transform:uppercase;cursor:pointer;transition:all 0.4s ease;
}
.cl-submit-btn:hover {
  color:var(--white-pure);border-color:rgba(255,26,26,0.4);
  box-shadow:0 0 20px rgba(255,26,26,0.1);
}
.cl-feedback {
  font-family:'Orbitron',sans-serif;font-size:0.55rem;letter-spacing:0.3em;
  margin-top:16px;height:18px;
}
.cl-feedback.denied { color:var(--accent-red); }
.cl-feedback.granted { color:var(--accent-green); }

/* Waveform background */
.cl-waveform {
  position:absolute;bottom:0;left:0;width:100%;height:100%;
  display:flex;align-items:flex-end;gap:1px;
  opacity:0;overflow:hidden;z-index:0;pointer-events:none;
  transition:opacity 0.8s ease;
}
.cl-track.playing .cl-waveform { opacity:0.05; }
.cl-wv {
  flex:1;min-width:0;
  background:linear-gradient(to top, var(--accent-blue), rgba(0,162,255,0.15));
  min-height:1px;
}

.music-cta { text-align:center;margin-top:70px; }
.music-cta-link {
  display:inline-flex;align-items:center;gap:14px;
  padding:16px 44px;border:1px solid rgba(0,162,255,0.15);
  text-decoration:none;transition:all 0.6s ease;position:relative;overflow:hidden;
}
.music-cta-link:hover {
  border-color:var(--accent-blue);box-shadow:0 0 30px rgba(0,162,255,0.1);
  transform:translateY(-2px);
}
.music-cta-link span {
  font-family:'Orbitron',sans-serif;font-size:0.6rem;letter-spacing:0.3em;
  text-transform:uppercase;color:var(--white);
}
.music-cta-link svg { width:16px;height:16px;color:var(--accent-blue);transition:transform 0.4s ease; }
.music-cta-link:hover svg { transform:translateX(6px); }

@media(max-width:768px) {
  .music-section { padding:120px 20px 60px; }
  .cl-track { padding:22px 20px;flex-direction:column;align-items:flex-start;gap:16px; }
  .cl-play { width:50px;height:50px;min-width:50px; }
  .cl-stamp-text { font-size:0.6rem;letter-spacing:0.2em;padding:4px 16px; }
  .cl-modal { padding:36px 24px; }
}


/* ═══ REGISTRY BREACH MONITOR ═══ */
.breach-monitor {
  margin-top:100px;padding:40px 0;
  border-top:1px solid rgba(255,255,255,0.02);
  text-align:center;position:relative;
}
.breach-border {
  width:50px;height:1px;background:rgba(255,26,26,0.15);margin:0 auto 32px;
  box-shadow:0 0 8px rgba(255,26,26,0.1);
}
.breach-header {
  display:flex;align-items:center;justify-content:center;gap:12px;margin-bottom:28px;
}
.breach-indicator {
  width:4px;height:4px;border-radius:50%;background:rgba(255,26,26,0.25);
  animation:breachBlink 3s ease-in-out infinite;
}
@keyframes breachBlink {
  0%,85%,100%{opacity:0.25} 90%{opacity:1;box-shadow:0 0 6px rgba(255,26,26,0.5)}
}
.breach-label {
  font-family:'Space Mono',monospace;font-size:0.4rem;
  letter-spacing:0.6em;text-transform:uppercase;color:rgba(255,255,255,0.1);
}

.breach-counter {
  font-family:'Orbitron',sans-serif;margin-bottom:20px;
  display:flex;align-items:baseline;justify-content:center;gap:6px;
}
.breach-prefix {
  font-size:0.55rem;font-weight:700;letter-spacing:0.2em;
  color:rgba(255,255,255,0.2);
}
.breach-value {
  font-size:1.8rem;font-weight:900;letter-spacing:0.05em;
  color:var(--accent-red);
  text-shadow:0 0 20px rgba(255,26,26,0.15);
  transition:all 0.5s ease;
}
.breach-value.pulse {
  text-shadow:0 0 40px rgba(255,26,26,0.5);
  transform:scale(1.15);
}
.breach-sep {
  font-size:1rem;font-weight:400;color:rgba(255,255,255,0.06);
}
.breach-threshold {
  font-size:1rem;font-weight:700;color:rgba(255,255,255,0.08);
}

/* Progress bar — system monitor style */
.breach-bar-track {
  width:280px;height:2px;margin:0 auto 24px;
  background:rgba(255,255,255,0.03);position:relative;overflow:hidden;
}
.breach-bar-fill {
  height:100%;width:0%;background:var(--accent-red);
  box-shadow:0 0 8px rgba(255,26,26,0.3);
  transition:width 0.8s ease;
}
.breach-bar-scanline {
  position:absolute;top:0;left:-100%;width:40%;height:100%;
  background:linear-gradient(90deg,transparent,rgba(255,255,255,0.08),transparent);
  animation:breachScan 4s linear infinite;
}
@keyframes breachScan {
  0%{left:-40%} 100%{left:140%}
}

.breach-desc {
  font-family:'Rajdhani',sans-serif;font-size:0.8rem;font-weight:300;
  color:rgba(255,255,255,0.08);letter-spacing:0.08em;line-height:1.8;
  max-width:420px;margin:0 auto;
}

.breach-status {
  font-family:'Orbitron',sans-serif;font-size:0.45rem;font-weight:700;
  letter-spacing:0.35em;color:rgba(255,255,255,0.06);margin-top:24px;
  transition:all 0.6s ease;
}
.breach-status.released {
  color:var(--accent-green);
  text-shadow:0 0 12px rgba(0,232,110,0.2);
}

/* Unlock animation — system clearance */
.cl-overlay.clearing {
  animation:clClearance 1.2s ease forwards;
}
@keyframes clClearance {
  0% { opacity:1; }
  15% { opacity:1;transform:translateX(-2px); }
  20% { opacity:0.7;transform:translateX(2px); }
  25% { opacity:1;transform:translateX(0); }
  35% { opacity:0.5; }
  40% { opacity:0.8;transform:translateX(-1px); }
  45% { opacity:0.3;transform:translateX(1px); }
  60% { opacity:0.15;transform:translateX(0); }
  100% { opacity:0;pointer-events:none; }
}

/* Scanline pulse on track during unlock */
.cl-track.clearance-pulse::after {
  content:'';position:absolute;top:0;left:0;width:100%;height:100%;
  z-index:4;pointer-events:none;
  background:linear-gradient(180deg,transparent 0%,rgba(255,26,26,0.03) 50%,transparent 100%);
  animation:clearanceSweep 0.8s ease-out forwards;
}
@keyframes clearanceSweep {
  0% { transform:translateY(-100%);opacity:1; }
  100% { transform:translateY(100%);opacity:0; }
}

/* Track reveal animation */
.cl-track .cl-info, .cl-track .cl-play, .cl-track .cl-track-num {
  transition:opacity 0.6s ease 0.4s;
}

@media(max-width:768px) {
  .breach-bar-track { width:200px; }
  .breach-value { font-size:1.4rem; }
  .breach-prefix { font-size:0.45rem; }
}


/* ═══ EXPLORE CITY BUTTON ═══ */
.explore-city-btn {
  display:inline-flex;align-items:center;gap:14px;
  margin-top:40px;padding:16px 36px;
  background:none;border:1px solid rgba(255,255,255,0.06);
  cursor:pointer;transition:all 0.6s ease;
}
.explore-city-btn:hover {
  border-color:rgba(255,214,0,0.2);
  box-shadow:0 0 30px rgba(255,214,0,0.04);
  transform:translateY(-2px);
}
.explore-city-icon svg { width:18px;height:18px;color:rgba(255,255,255,0.2);transition:color 0.4s ease; }
.explore-city-btn:hover .explore-city-icon svg { color:var(--accent-yellow); }
.explore-city-text {
  font-family:'Orbitron',sans-serif;font-size:0.6rem;font-weight:700;
  letter-spacing:0.3em;color:rgba(255,255,255,0.3);transition:color 0.4s ease;
}
.explore-city-btn:hover .explore-city-text { color:var(--white-pure); }

/* ═══ CITY MAP MODAL ═══ */
.city-map-overlay {
  position:fixed;top:0;left:0;width:100%;height:100%;z-index:99998;
  background:#000;display:none;
  flex-direction:column;overflow:hidden;
}
.city-map-overlay.open { display:flex; }

.city-map-header {
  display:flex;align-items:center;justify-content:space-between;
  padding:20px 28px;border-bottom:1px solid rgba(255,255,255,0.03);
  flex-shrink:0;z-index:10;
}
.city-map-title-area { display:flex;align-items:center;gap:14px; }
.city-map-label {
  font-family:'Space Mono',monospace;font-size:0.4rem;
  letter-spacing:0.5em;text-transform:uppercase;color:rgba(255,255,255,0.1);
}
.city-map-title {
  font-family:'Orbitron',sans-serif;font-size:0.9rem;font-weight:900;
  letter-spacing:0.2em;color:var(--white-pure);
}
.city-map-close {
  background:none;border:1px solid rgba(255,255,255,0.06);
  color:rgba(255,255,255,0.3);padding:8px 16px;cursor:pointer;
  font-family:'Orbitron',sans-serif;font-size:0.5rem;letter-spacing:0.2em;
  transition:all 0.3s ease;
}
.city-map-close:hover { color:var(--white-pure);border-color:rgba(255,255,255,0.15); }

.city-map-viewport {
  flex:1;overflow:hidden;position:relative;cursor:grab;
  touch-action:none;
}
.city-map-viewport:active { cursor:grabbing; }

/* Film grain on map */
.city-map-viewport::after {
  content:'';position:absolute;top:0;left:0;width:100%;height:100%;
  pointer-events:none;z-index:5;opacity:0.04;
  background-image:url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)'/%3E%3C/svg%3E");
}

.city-map-canvas {
  position:absolute;top:0;left:0;
  transform-origin:0 0;
  width:1600px;height:1200px;
}

/* Map background */
.city-map-bg {
  position:absolute;top:0;left:0;width:100%;height:100%;
}

/* Location markers */
.city-loc {
  position:absolute;cursor:pointer;z-index:3;
  transition:all 0.4s ease;
}
.city-loc:hover { z-index:6; }

.city-loc-marker {
  position:relative;display:flex;flex-direction:column;align-items:center;
}
.city-loc-dot {
  width:10px;height:10px;border-radius:50%;
  border:1.5px solid rgba(255,255,255,0.25);background:rgba(255,255,255,0.05);
  transition:all 0.4s ease;position:relative;z-index:2;
}
.city-loc:hover .city-loc-dot {
  border-color:rgba(255,255,255,0.6);background:rgba(255,255,255,0.15);
  box-shadow:0 0 15px rgba(255,255,255,0.1);
}
.city-loc.active .city-loc-dot {
  border-color:var(--accent-yellow);background:rgba(255,214,0,0.15);
  box-shadow:0 0 20px rgba(255,214,0,0.15);
}
.city-loc-ping {
  position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);
  width:10px;height:10px;border-radius:50%;
  border:1px solid rgba(255,255,255,0.1);
  animation:locPing 3s ease-out infinite;
}
@keyframes locPing {
  0%{width:10px;height:10px;opacity:0.4}
  100%{width:40px;height:40px;opacity:0}
}

.city-loc-name {
  font-family:'Orbitron',sans-serif;font-size:0.45rem;font-weight:700;
  letter-spacing:0.2em;color:rgba(255,255,255,0.25);
  margin-top:8px;white-space:nowrap;
  text-shadow:0 0 10px rgba(0,0,0,0.8);
  transition:color 0.4s ease;
}
.city-loc:hover .city-loc-name { color:rgba(255,255,255,0.6); }
.city-loc.active .city-loc-name { color:var(--accent-yellow); }

/* Special color overrides */
.city-loc.loc-freefall .city-loc-name { color:rgba(255,26,26,0.35); }
.city-loc.loc-freefall:hover .city-loc-name,
.city-loc.loc-freefall.active .city-loc-name { color:var(--accent-red); }
.city-loc.loc-freefall .city-loc-dot { border-color:rgba(255,26,26,0.2); }
.city-loc.loc-freefall:hover .city-loc-dot { border-color:rgba(255,26,26,0.5);box-shadow:0 0 12px rgba(255,26,26,0.1); }

.city-loc.loc-ghostwater .city-loc-dot { border-color:rgba(0,162,255,0.15); }
.city-loc.loc-ghostwater:hover .city-loc-dot { border-color:rgba(0,162,255,0.4);box-shadow:0 0 12px rgba(0,162,255,0.1); }

/* Buildings / structures (SVG-drawn in canvas) */
.city-building {
  position:absolute;z-index:1;opacity:0.12;
}

/* Info panel */
.city-info {
  position:fixed;bottom:0;left:0;width:100%;z-index:20;
  padding:28px 32px;
  background:linear-gradient(180deg,transparent 0%,rgba(0,0,0,0.95) 30%);
  transform:translateY(100%);transition:transform 0.5s ease;
  pointer-events:none;
}
.city-info.visible { transform:translateY(0);pointer-events:auto; }
.city-info-zone {
  font-family:'Space Mono',monospace;font-size:0.4rem;
  letter-spacing:0.5em;text-transform:uppercase;color:rgba(255,255,255,0.1);
  margin-bottom:6px;
}
.city-info-name {
  font-family:'Orbitron',sans-serif;font-size:1.1rem;font-weight:900;
  letter-spacing:0.15em;color:var(--white-pure);margin-bottom:8px;
}
.city-info-desc {
  font-family:'Rajdhani',sans-serif;font-size:0.85rem;font-weight:300;
  color:rgba(255,255,255,0.25);letter-spacing:0.05em;line-height:1.6;
  max-width:500px;
}
.city-info-name.red { color:var(--accent-red); }

/* Zoom controls */
.city-zoom {
  position:absolute;bottom:90px;right:20px;z-index:10;
  display:flex;flex-direction:column;gap:4px;
}
.city-zoom button {
  width:36px;height:36px;background:rgba(0,0,0,0.7);
  border:1px solid rgba(255,255,255,0.06);color:rgba(255,255,255,0.3);
  font-family:'Orbitron',sans-serif;font-size:0.9rem;cursor:pointer;
  display:flex;align-items:center;justify-content:center;
  transition:all 0.3s ease;
}
.city-zoom button:hover { color:var(--white-pure);border-color:rgba(255,255,255,0.15); }

/* Fog layers */
.city-fog {
  position:absolute;pointer-events:none;z-index:2;
}
.city-fog-1 {
  top:5%;left:0;width:100%;height:30%;
  background:radial-gradient(ellipse at 25% 50%,rgba(40,40,45,0.4) 0%,transparent 70%);
  animation:fogDrift 20s ease-in-out infinite alternate;
}
.city-fog-2 {
  bottom:10%;right:0;width:80%;height:25%;
  background:radial-gradient(ellipse at 75% 50%,rgba(30,30,35,0.3) 0%,transparent 60%);
  animation:fogDrift 25s ease-in-out infinite alternate-reverse;
}
@keyframes fogDrift {
  0%{transform:translateX(-3%)} 100%{transform:translateX(3%)}
}

/* Ruinbow smoke (selective color) */
.city-smoke {
  position:absolute;pointer-events:none;z-index:2;
}
.city-smoke-puff {
  position:absolute;border-radius:50%;filter:blur(30px);
  animation:smokePuff 8s ease-in-out infinite;
}
@keyframes smokePuff {
  0%,100%{transform:translateY(0) scale(1);opacity:0.08}
  50%{transform:translateY(-15px) scale(1.2);opacity:0.15}
}

/* Ghostwater prism glow */
.city-prism-glow {
  position:absolute;pointer-events:none;z-index:2;
  width:60px;height:60px;border-radius:50%;
  background:radial-gradient(circle,rgba(100,180,255,0.08) 0%,rgba(180,100,255,0.04) 40%,transparent 70%);
  animation:prismPulse 5s ease-in-out infinite;
}
@keyframes prismPulse {
  0%,100%{transform:scale(1);opacity:0.6} 50%{transform:scale(1.3);opacity:1}
}

/* Wondrix barrier */
.city-barrier {
  position:absolute;pointer-events:none;z-index:2;
  border:1px dashed rgba(255,255,255,0.04);
  border-radius:8px;
}

@media(max-width:768px) {
  .city-map-header { padding:14px 16px; }
  .city-map-title { font-size:0.7rem; }
  .city-info { padding:20px 20px; }
  .city-info-name { font-size:0.9rem; }
}

/* ═══ GALLERY ═══ */
.gallery-portal {
  margin-top:120px;padding-top:80px;text-align:center;
  border-top:1px solid rgba(255,255,255,0.03);
}
.gallery-border-top {
  width:40px;height:1px;background:var(--accent-yellow);margin:0 auto 40px;
  box-shadow:0 0 12px rgba(255,214,0,0.3);
}
.gallery-icon {
  margin-bottom:20px;
}
.gallery-icon svg {
  width:32px;height:32px;color:rgba(255,255,255,0.1);
}
.gallery-label {
  font-family:'Space Mono',monospace;font-size:0.5rem;
  letter-spacing:0.4em;text-transform:uppercase;color:var(--accent-yellow);
  margin-bottom:12px;
}
.gallery-title {
  font-family:'Orbitron',sans-serif;font-size:clamp(1.5rem,3.5vw,2.8rem);font-weight:900;
  letter-spacing:0.2em;color:var(--white-pure);margin-bottom:16px;
}
.gallery-desc {
  font-family:'Rajdhani',sans-serif;font-size:0.95rem;font-weight:300;
  color:rgba(255,255,255,0.2);letter-spacing:0.08em;max-width:500px;margin:0 auto 50px;
  line-height:1.7;
}

.gallery-grid {
  display:grid;grid-template-columns:repeat(3,1fr);gap:10px;
  max-width:800px;margin:0 auto;
}
.gallery-slot {
  position:relative;overflow:hidden;cursor:pointer;
  border:1px solid rgba(255,255,255,0.03);
  transition:all 0.5s ease;
}
.gallery-slot:hover {
  border-color:rgba(255,214,0,0.15);
  box-shadow:0 0 25px rgba(255,214,0,0.04);
  transform:scale(1.02);z-index:2;
}
.gallery-slot img {
  width:100%;height:100%;object-fit:cover;display:block;
  filter:grayscale(15%) contrast(1.05);
  transition:filter 0.5s ease, transform 0.6s ease;
}
.gallery-slot:hover img {
  filter:grayscale(0%) contrast(1.1);
  transform:scale(1.05);
}
/* Overlay number */
.gallery-slot::after {
  content:attr(data-num);position:absolute;bottom:8px;right:10px;
  font-family:'Orbitron',sans-serif;font-size:0.4rem;font-weight:700;
  letter-spacing:0.2em;color:rgba(255,255,255,0.06);
  pointer-events:none;transition:color 0.4s ease;
}
.gallery-slot:hover::after { color:rgba(255,214,0,0.15); }

/* Lightbox */
.gallery-lightbox {
  position:fixed;top:0;left:0;width:100%;height:100%;z-index:99999;
  background:rgba(0,0,0,0.97);display:none;
  align-items:center;justify-content:center;
  cursor:pointer;
}
.gallery-lightbox.open { display:flex; }
.gallery-lightbox img {
  max-width:90vw;max-height:85vh;object-fit:contain;
  border:1px solid rgba(255,255,255,0.03);
}
.gallery-lightbox-close {
  position:absolute;top:20px;right:24px;
  background:none;border:1px solid rgba(255,255,255,0.06);
  color:rgba(255,255,255,0.3);padding:8px 16px;cursor:pointer;
  font-family:'Orbitron',sans-serif;font-size:0.5rem;letter-spacing:0.2em;
  transition:all 0.3s ease;z-index:2;
}
.gallery-lightbox-close:hover { color:var(--white-pure);border-color:rgba(255,255,255,0.15); }
.gallery-lightbox-nav {
  position:absolute;top:50%;transform:translateY(-50%);
  background:none;border:1px solid rgba(255,255,255,0.06);
  color:rgba(255,255,255,0.25);width:44px;height:44px;
  display:flex;align-items:center;justify-content:center;
  cursor:pointer;font-size:1.2rem;transition:all 0.3s ease;z-index:2;
}
.gallery-lightbox-nav:hover { color:var(--white-pure);border-color:rgba(255,255,255,0.15); }
.gallery-lightbox-nav.prev { left:16px; }
.gallery-lightbox-nav.next { right:16px; }
.gallery-lightbox-caption {
  position:absolute;bottom:20px;left:50%;transform:translateX(-50%);
  font-family:'Space Mono',monospace;font-size:0.4rem;letter-spacing:0.4em;
  text-transform:uppercase;color:rgba(255,255,255,0.1);
}

.gallery-coming {
  display:none;
}

@media(max-width:768px) {
  .gallery-grid { grid-template-columns:repeat(2,1fr);gap:6px; }
  .gallery-lightbox-nav { width:36px;height:36px;font-size:1rem; }
  .gallery-lightbox-nav.prev { left:8px; }
  .gallery-lightbox-nav.next { right:8px; }
}

/* ═══ STORE ═══ */
.store-coming-soon {
  min-height:100vh;display:flex;flex-direction:column;
  align-items:center;justify-content:center;text-align:center;
  padding:80px 48px;
}
.store-coming-label { margin-bottom:24px; }
.store-coming-title {
  font-family:'Orbitron',sans-serif;font-size:clamp(2.5rem,7vw,5rem);font-weight:900;
  letter-spacing:0.25em;color:var(--white-pure);
  text-shadow:0 0 60px rgba(0,232,110,0.06);
}
.store-coming-divider {
  width:60px;height:1px;background:var(--accent-green);margin:40px auto;
  box-shadow:0 0 12px rgba(0,232,110,0.3);
}
.store-coming-desc {
  font-family:'Rajdhani',sans-serif;font-size:1rem;font-weight:300;
  color:rgba(255,255,255,0.15);letter-spacing:0.1em;line-height:1.8;
  max-width:440px;margin-bottom:50px;
}
.store-coming-grid {
  display:flex;gap:16px;margin-bottom:50px;
}
.store-coming-slot {
  width:80px;height:80px;border:1px solid rgba(255,255,255,0.03);
  background:rgba(255,255,255,0.01);
}
.store-coming-notify {
  display:inline-flex;align-items:center;gap:10px;
  padding:12px 28px;border:1px solid rgba(0,232,110,0.1);
}
.store-coming-dot {
  width:6px;height:6px;border-radius:50%;background:var(--accent-green);
  animation:storePulse 2s ease-in-out infinite;
}
@keyframes storePulse {
  0%,100% { opacity:0.3;box-shadow:0 0 4px rgba(0,232,110,0.2); }
  50% { opacity:1;box-shadow:0 0 12px rgba(0,232,110,0.5); }
}
.store-coming-notify span {
  font-family:'Space Mono',monospace;font-size:0.5rem;
  letter-spacing:0.25em;text-transform:uppercase;color:rgba(255,255,255,0.2);
}

/* ═══ LUX OR NOX ═══ */
.luxnox-section {
  min-height:100vh;display:flex;align-items:center;justify-content:center;
  position:relative;overflow:hidden;
}
.luxnox-bg {
  position:absolute;top:0;left:0;width:100%;height:100%;
  background:radial-gradient(circle at 30% 40%,rgba(0,162,255,0.05) 0%,transparent 50%),
              radial-gradient(circle at 70% 60%,rgba(255,26,26,0.04) 0%,transparent 50%);
}
.luxnox-content { text-align:center;z-index:3;position:relative; }
.luxnox-question {
  font-family:'Space Mono',monospace;font-size:0.6rem;letter-spacing:0.6em;
  text-transform:uppercase;color:rgba(255,255,255,0.2);margin-bottom:50px;
}
.luxnox-title {
  font-family:'Orbitron',sans-serif;font-size:clamp(3rem,9vw,9rem);font-weight:900;
  letter-spacing:0.08em;line-height:1;position:relative;
}
.luxnox-lux {
  color:var(--accent-blue);text-shadow:0 0 80px rgba(0,162,255,0.25),0 0 160px rgba(0,162,255,0.1);
  display:block;
}
.luxnox-or {
  font-family:'Rajdhani',sans-serif;font-size:clamp(0.8rem,1.5vw,1.2rem);font-weight:300;
  letter-spacing:1em;color:rgba(255,255,255,0.12);display:block;margin:20px 0;
}
.luxnox-nox {
  color:var(--accent-red);text-shadow:0 0 80px rgba(255,26,26,0.3),0 0 160px rgba(255,26,26,0.12);
  display:block;
}

.luxnox-enter {
  display:inline-flex;align-items:center;gap:14px;margin-top:60px;
  padding:16px 44px;border:1px solid rgba(255,255,255,0.08);
  background:transparent;text-decoration:none;
  transition:all 0.6s var(--transition-smooth);cursor:pointer;
  position:relative;overflow:hidden;
}
.luxnox-enter::before {
  content:'';position:absolute;top:0;left:-100%;width:100%;height:100%;
  background:linear-gradient(90deg,transparent,rgba(255,26,26,0.08),transparent);
  transition:left 0.6s ease;
}
.luxnox-enter:hover::before { left:100%; }
.luxnox-enter:hover {
  border-color:var(--accent-red);box-shadow:0 0 40px rgba(255,26,26,0.12);transform:scale(1.02);
}
.luxnox-enter span {
  font-family:'Orbitron',sans-serif;font-size:0.6rem;letter-spacing:0.4em;
  text-transform:uppercase;color:var(--white);
}
.luxnox-enter svg { width:16px;height:16px;color:var(--accent-red);transition:transform 0.4s ease; }
.luxnox-enter:hover svg { transform:translateX(6px); }
.luxnox-warning {
  font-family:'Space Mono',monospace;font-size:0.45rem;letter-spacing:0.3em;
  text-transform:uppercase;color:rgba(255,255,255,0.06);margin-top:50px;
}

/* ═══ FOOTER ═══ */
.footer {
  border-top:1px solid rgba(255,255,255,0.04);padding:50px 48px;
  display:flex;align-items:center;justify-content:space-between;position:relative;z-index:2;
}
.footer-logo {
  font-family:'Orbitron',sans-serif;font-size:0.65rem;font-weight:700;
  letter-spacing:0.4em;color:rgba(255,255,255,0.15);
}
.footer-copy {
  font-family:'Space Mono',monospace;font-size:0.5rem;letter-spacing:0.2em;
  color:rgba(255,255,255,0.08);
}

/* ═══ CURSOR ═══ */
.cursor-dot {
  position:fixed;width:6px;height:6px;background:var(--white-pure);border-radius:50%;
  pointer-events:none;z-index:99999;mix-blend-mode:difference;
  transition:transform 0.15s ease,opacity 0.3s ease;
}
.cursor-ring {
  position:fixed;width:34px;height:34px;border:1px solid rgba(255,255,255,0.2);
  border-radius:50%;pointer-events:none;z-index:99998;
  transition:transform 0.4s var(--transition-smooth),width 0.3s ease,height 0.3s ease,border-color 0.3s ease;
  transform:translate(-50%,-50%);
}
.cursor-ring.hovering { width:52px;height:52px;border-color:var(--accent-red);opacity:0.5; }

/* ═══ PAGE TRANSITION ═══ */
.page-transition {
  position:fixed;top:0;left:0;width:100%;height:100%;z-index:99990;
  pointer-events:none;display:flex;
}
.transition-slice {
  flex:1;background:var(--black);transform:scaleY(0);transform-origin:top;
}
.page-transition.active .transition-slice { animation:transSlice 0.5s var(--transition-cinematic) forwards; }
.page-transition.active .transition-slice:nth-child(2){animation-delay:0.02s}
.page-transition.active .transition-slice:nth-child(3){animation-delay:0.04s}
.page-transition.active .transition-slice:nth-child(4){animation-delay:0.06s}
.page-transition.active .transition-slice:nth-child(5){animation-delay:0.08s}
@keyframes transSlice {
  0%{transform:scaleY(0);transform-origin:top}45%{transform:scaleY(1);transform-origin:top}
  55%{transform:scaleY(1);transform-origin:bottom}100%{transform:scaleY(0);transform-origin:bottom}
}

/* Ink Canvas */
#inkCanvas {
  position:fixed;top:0;left:0;width:100%;height:100%;z-index:9996;
  pointer-events:none;opacity:0;transition:opacity 0.5s ease;
}
#inkCanvas.active { opacity:1; }

/* Ambient Orbs */
.ambient-orb {
  position:fixed;border-radius:50%;filter:blur(80px);pointer-events:none;z-index:0;
  animation:orbFloat 20s ease-in-out infinite;
}
@keyframes orbFloat {
  0%,100%{transform:translate(0,0) scale(1)}25%{transform:translate(30px,-20px) scale(1.1)}
  50%{transform:translate(-20px,30px) scale(0.9)}75%{transform:translate(20px,20px) scale(1.05)}
}

/* Frequency visualizer */


/* ═══ RESPONSIVE ═══ */
@media(max-width:1024px){
  .product-grid{grid-template-columns:repeat(2,1fr)}
  .social-links{display:none}.stats-row{gap:40px}
}
@media(max-width:768px){
  .nav{padding:18px 20px}.nav.scrolled{padding:12px 20px}
  .nav-links{gap:16px}.nav-link{font-size:0.5rem;letter-spacing:0.12em}
  .about-section,.store-section{padding:100px 24px}
  .lore-content{padding:0 24px 100px}
  .product-grid{grid-template-columns:1fr}
  .lore-gallery{grid-template-columns:1fr}
  .stats-row{flex-direction:column;gap:30px}
  .footer{padding:30px 24px;flex-direction:column;gap:16px;text-align:center}
  .cursor-dot,.cursor-ring{display:none}
  
}
</style>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-database-compat.js"></script>
</head>
<body>

<div class="film-grain"></div>
<div class="vignette"></div>
<div class="scanlines"></div>
<div class="particles-container" id="particles"></div>

<div class="ambient-orb" style="width:300px;height:300px;background:rgba(255,26,26,0.012);top:20%;left:10%;animation-delay:-5s"></div>
<div class="ambient-orb" style="width:400px;height:400px;background:rgba(0,240,255,0.008);bottom:10%;right:5%;animation-delay:-12s"></div>

<div class="cursor-dot" id="cursorDot"></div>
<div class="cursor-ring" id="cursorRing"></div>
<canvas id="inkCanvas"></canvas>

<div class="page-transition" id="pageTransition">
  <div class="transition-slice"></div><div class="transition-slice"></div>
  <div class="transition-slice"></div><div class="transition-slice"></div>
  <div class="transition-slice"></div>
</div>



<!-- Navigation (centered, no logo text) -->
<nav class="nav" id="nav">
  <ul class="nav-links">
    <li><a class="nav-link active" data-section="landing" onclick="navigateTo('landing')"><span class="nav-dot"></span>Origin</a></li>
    <li><a class="nav-link" data-section="music" onclick="navigateTo('music')"><span class="nav-dot"></span>Music</a></li>
    <li><a class="nav-link" data-section="store" onclick="navigateTo('store')"><span class="nav-dot"></span>Store</a></li>
    <li><a class="nav-link" data-section="story" onclick="navigateTo('story')"><span class="nav-dot"></span>Story</a></li>
    <li><a class="nav-link" data-section="luxnox" onclick="navigateTo('luxnox')"><span class="nav-dot luxnox-dot"></span>Lux or Nox</a></li>
  </ul>
</nav>

<!-- Audio Toggle -->
<button class="audio-toggle muted" id="audioToggle" onclick="toggleAudio()">
  <span class="audio-label">Enable Sound</span>
  <div class="audio-bar" style="height:8px"></div>
  <div class="audio-bar" style="height:14px"></div>
  <div class="audio-bar" style="height:6px"></div>
  <div class="audio-bar" style="height:12px"></div>
</button>

<!-- Social Links (sidebar) -->
<div class="social-links" id="socialLinks" style="display:none">
  <a href="https://open.spotify.com/artist/03jNHXaMwqTn3udFAljkHo" target="_blank" class="social-link" title="Spotify">
    <svg viewBox="0 0 24 24"><path d="M12 0C5.4 0 0 5.4 0 12s5.4 12 12 12 12-5.4 12-12S18.66 0 12 0zm5.521 17.34c-.24.359-.66.48-1.021.24-2.82-1.74-6.36-2.101-10.561-1.141-.418.122-.779-.179-.899-.539-.12-.421.18-.78.54-.9 4.56-1.021 8.52-.6 11.64 1.32.42.18.479.659.301 1.02zm1.44-3.3c-.301.42-.841.6-1.262.3-3.239-1.98-8.159-2.58-11.939-1.38-.479.12-1.02-.12-1.14-.6-.12-.48.12-1.021.6-1.141C9.6 9.9 15 10.561 18.72 12.84c.361.181.54.78.241 1.2zm.12-3.36C15.24 8.4 8.82 8.16 5.16 9.301c-.6.179-1.2-.181-1.38-.721-.18-.601.18-1.2.72-1.381 4.26-1.26 11.28-1.02 15.721 1.621.539.3.719 1.02.419 1.56-.299.421-1.02.599-1.559.3z"/></svg>
  </a>
  <a href="https://www.instagram.com/iamkroma" target="_blank" class="social-link" title="Instagram">
    <svg viewBox="0 0 24 24"><path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zM12 0C8.741 0 8.333.014 7.053.072 2.695.272.273 2.69.073 7.052.014 8.333 0 8.741 0 12c0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98C8.333 23.986 8.741 24 12 24c3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98C15.668.014 15.259 0 12 0zm0 5.838a6.162 6.162 0 100 12.324 6.162 6.162 0 000-12.324zM12 16a4 4 0 110-8 4 4 0 010 8zm6.406-11.845a1.44 1.44 0 100 2.881 1.44 1.44 0 000-2.881z"/></svg>
  </a>
  <a href="https://soundcloud.com/iam-kroma/tracks" target="_blank" class="social-link" title="SoundCloud">
    <svg viewBox="0 0 24 24"><path d="M1.175 12.225c-.051 0-.094.046-.101.1l-.233 2.154.233 2.105c.007.058.05.098.101.098.05 0 .09-.04.099-.098l.255-2.105-.27-2.154c-.009-.057-.05-.1-.1-.1m-.899.828c-.06 0-.091.037-.104.094L0 14.479l.172 1.282c.013.06.045.094.104.094.057 0 .089-.035.104-.094l.193-1.282-.193-1.332c-.015-.057-.047-.094-.104-.094m1.806-.474c-.066 0-.12.046-.127.112l-.209 2.088.209 2.058c.007.065.061.11.127.11.065 0 .12-.045.126-.11l.239-2.058-.239-2.088c-.006-.066-.061-.112-.126-.112m.89-.057c-.074 0-.131.053-.137.12L2.6 14.779l.235 2.042c.006.07.063.12.137.12.074 0 .131-.05.138-.12l.266-2.042-.266-2.237c-.007-.067-.064-.12-.138-.12m.902-.143c-.08 0-.144.06-.15.13l-.2 2.38.2 2.018c.006.075.07.13.15.13.08 0 .143-.055.15-.13l.228-2.018-.228-2.38c-.007-.07-.07-.13-.15-.13m.907-.19c-.088 0-.158.065-.164.142l-.186 2.57.186 1.985c.006.082.076.14.164.14.087 0 .158-.058.164-.14l.21-1.985-.21-2.57c-.006-.077-.077-.142-.164-.142m.936-.137c-.095 0-.172.07-.177.152l-.17 2.707.17 1.954c.005.088.082.152.177.152s.172-.064.178-.152l.194-1.954-.194-2.707c-.006-.082-.083-.152-.178-.152m.922-.164c-.104 0-.186.08-.191.166l-.154 2.871.154 1.932c.005.092.087.16.19.16.104 0 .186-.068.192-.16l.176-1.932-.176-2.871c-.006-.086-.088-.166-.191-.166m.94-.108c-.11 0-.2.085-.204.176l-.14 2.98.14 1.907c.005.097.094.17.204.17.11 0 .2-.073.206-.17l.159-1.907-.16-2.98c-.005-.091-.095-.176-.205-.176m.94-.1c-.12 0-.214.09-.218.186l-.127 3.08.127 1.886c.004.103.098.18.218.18.12 0 .213-.077.218-.18l.145-1.886-.145-3.08c-.005-.096-.098-.186-.218-.186m.955-.028c-.126 0-.226.098-.23.198l-.114 3.108.114 1.86c.004.107.104.19.23.19.126 0 .226-.083.23-.19l.13-1.86-.13-3.108c-.004-.1-.104-.198-.23-.198m8.376 1.017c-.393 0-.77.062-1.124.178-.232-2.617-2.44-4.672-5.136-4.672-.702 0-1.38.137-1.998.38-.231.09-.293.182-.295.36v9.392c.002.186.152.34.336.357h8.217c1.543 0 2.794-1.262 2.794-2.82 0-1.558-1.251-2.82-2.794-2.82"/></svg>
  </a>
  <a href="https://x.com/iamkroma" target="_blank" class="social-link" title="X">
    <svg viewBox="0 0 24 24"><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/></svg>
  </a>
</div>

<!-- ═══ LANDING ═══ -->
<section class="section active" id="section-landing">
  <div class="hero">
    <div class="hero-bg"></div>
    <div class="hero-grid"></div>
    <div class="hero-content">
      <p class="hero-eyebrow">BLACK AND WHITE — COLOR UNSTABLE</p>
      <h1 class="hero-title-text">KROMA</h1>
      <p class="hero-subtitle">VISION &nbsp;·&nbsp; SOUND &nbsp;·&nbsp; WORLD</p>
      <div class="hero-divider"></div>
      <p class="hero-tagline">Where sound becomes world.</p>
    </div>
    <div class="scroll-indicator">
      <span>Descend</span>
      <div class="scroll-line"></div>
    </div>
  </div>
  <div class="about-section">
    <div class="section-label">Transmission 001</div>
    <h2 class="about-heading">Who is KROMA?</h2>
    <p class="about-text">
      Kroma is an artist emerging from the fictional dystopian universe of <strong>Smilemore</strong>, a black and white world defined by <strong>selective color</strong>.
    </p>
    <p class="about-text" style="margin-top:28px;">
      Bouncing between light, melodic elements and dark, heavy mid-tempo basslines, Kroma's sound thrives in the tension between beauty and menace. Inspired by artists like <strong>Rezz</strong> and <strong>Lorn</strong>, his productions fuse hypnotic rhythms with immersive, atmospheric intensity.
    </p>
    <p class="about-text" style="margin-top:28px;">
      Within the Smilemore mythology, Kroma exists as a fractured figure forced to remain behind his <strong>nano-mask</strong>, unable to reveal his face without risking psychological collapse. In a world governed by moral division, every soul is classified as <strong style="color:var(--accent-blue)">Lux</strong> or <strong style="color:var(--accent-red)">Nox</strong>, yet Kroma moves uneasily between both.
    </p>
    <p class="about-text" style="margin-top:28px;">
      Each release serves as a chapter in an unfolding universe where identity, perception, and internal conflict shape the experience. As the Smilemore universe expands, Kroma stands as a uniquely conceptual presence — an artist defined as much by <strong>world-building</strong> as by <strong>sound</strong>.
    </p>
    <div class="welcome-smilemore">WELCOME TO SMILEMORE</div>

    <!-- Social Links Row -->
    <div class="social-row">
      <a href="https://open.spotify.com/artist/03jNHXaMwqTn3udFAljkHo" target="_blank" class="social-row-link">
        <svg viewBox="0 0 24 24"><path d="M12 0C5.4 0 0 5.4 0 12s5.4 12 12 12 12-5.4 12-12S18.66 0 12 0zm5.521 17.34c-.24.359-.66.48-1.021.24-2.82-1.74-6.36-2.101-10.561-1.141-.418.122-.779-.179-.899-.539-.12-.421.18-.78.54-.9 4.56-1.021 8.52-.6 11.64 1.32.42.18.479.659.301 1.02zm1.44-3.3c-.301.42-.841.6-1.262.3-3.239-1.98-8.159-2.58-11.939-1.38-.479.12-1.02-.12-1.14-.6-.12-.48.12-1.021.6-1.141C9.6 9.9 15 10.561 18.72 12.84c.361.181.54.78.241 1.2zm.12-3.36C15.24 8.4 8.82 8.16 5.16 9.301c-.6.179-1.2-.181-1.38-.721-.18-.601.18-1.2.72-1.381 4.26-1.26 11.28-1.02 15.721 1.621.539.3.719 1.02.419 1.56-.299.421-1.02.599-1.559.3z"/></svg>
        <span>Spotify</span>
      </a>
      <a href="https://www.instagram.com/iamkroma" target="_blank" class="social-row-link">
        <svg viewBox="0 0 24 24"><path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zM12 0C8.741 0 8.333.014 7.053.072 2.695.272.273 2.69.073 7.052.014 8.333 0 8.741 0 12c0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98C8.333 23.986 8.741 24 12 24c3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98C15.668.014 15.259 0 12 0zm0 5.838a6.162 6.162 0 100 12.324 6.162 6.162 0 000-12.324zM12 16a4 4 0 110-8 4 4 0 010 8zm6.406-11.845a1.44 1.44 0 100 2.881 1.44 1.44 0 000-2.881z"/></svg>
        <span>Instagram</span>
      </a>
      <a href="https://soundcloud.com/iam-kroma/tracks" target="_blank" class="social-row-link">
        <svg viewBox="0 0 24 24"><path d="M1.175 12.225c-.051 0-.094.046-.101.1l-.233 2.154.233 2.105c.007.058.05.098.101.098.05 0 .09-.04.099-.098l.255-2.105-.27-2.154c-.009-.057-.05-.1-.1-.1m-.899.828c-.06 0-.091.037-.104.094L0 14.479l.172 1.282c.013.06.045.094.104.094.057 0 .089-.035.104-.094l.193-1.282-.193-1.332c-.015-.057-.047-.094-.104-.094m1.806-.474c-.066 0-.12.046-.127.112l-.209 2.088.209 2.058c.007.065.061.11.127.11.065 0 .12-.045.126-.11l.239-2.058-.239-2.088c-.006-.066-.061-.112-.126-.112m.89-.057c-.074 0-.131.053-.137.12L2.6 14.779l.235 2.042c.006.07.063.12.137.12.074 0 .131-.05.138-.12l.266-2.042-.266-2.237c-.007-.067-.064-.12-.138-.12m.902-.143c-.08 0-.144.06-.15.13l-.2 2.38.2 2.018c.006.075.07.13.15.13.08 0 .143-.055.15-.13l.228-2.018-.228-2.38c-.007-.07-.07-.13-.15-.13m.907-.19c-.088 0-.158.065-.164.142l-.186 2.57.186 1.985c.006.082.076.14.164.14.087 0 .158-.058.164-.14l.21-1.985-.21-2.57c-.006-.077-.077-.142-.164-.142m.936-.137c-.095 0-.172.07-.177.152l-.17 2.707.17 1.954c.005.088.082.152.177.152s.172-.064.178-.152l.194-1.954-.194-2.707c-.006-.082-.083-.152-.178-.152m.922-.164c-.104 0-.186.08-.191.166l-.154 2.871.154 1.932c.005.092.087.16.19.16.104 0 .186-.068.192-.16l.176-1.932-.176-2.871c-.006-.086-.088-.166-.191-.166m.94-.108c-.11 0-.2.085-.204.176l-.14 2.98.14 1.907c.005.097.094.17.204.17.11 0 .2-.073.206-.17l.159-1.907-.16-2.98c-.005-.091-.095-.176-.205-.176m.94-.1c-.12 0-.214.09-.218.186l-.127 3.08.127 1.886c.004.103.098.18.218.18.12 0 .213-.077.218-.18l.145-1.886-.145-3.08c-.005-.096-.098-.186-.218-.186m.955-.028c-.126 0-.226.098-.23.198l-.114 3.108.114 1.86c.004.107.104.19.23.19.126 0 .226-.083.23-.19l.13-1.86-.13-3.108c-.004-.1-.104-.198-.23-.198m8.376 1.017c-.393 0-.77.062-1.124.178-.232-2.617-2.44-4.672-5.136-4.672-.702 0-1.38.137-1.998.38-.231.09-.293.182-.295.36v9.392c.002.186.152.34.336.357h8.217c1.543 0 2.794-1.262 2.794-2.82 0-1.558-1.251-2.82-2.794-2.82"/></svg>
        <span>SoundCloud</span>
      </a>
      <a href="https://x.com/iamkroma" target="_blank" class="social-row-link">
        <svg viewBox="0 0 24 24"><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/></svg>
        <span>X</span>
      </a>
      <a href="https://youtube.com/@iamkroma" target="_blank" class="social-row-link">
        <svg viewBox="0 0 24 24"><path d="M23.498 6.186a3.016 3.016 0 0 0-2.122-2.136C19.505 3.545 12 3.545 12 3.545s-7.505 0-9.377.505A3.017 3.017 0 0 0 .502 6.186C0 8.07 0 12 0 12s0 3.93.502 5.814a3.016 3.016 0 0 0 2.122 2.136c1.871.505 9.376.505 9.376.505s7.505 0 9.377-.505a3.015 3.015 0 0 0 2.122-2.136C24 15.93 24 12 24 12s0-3.93-.502-5.814zM9.545 15.568V8.432L15.818 12l-6.273 3.568z"/></svg>
        <span>YouTube</span>
      </a>
      <a href="https://www.tiktok.com/@iamkroma" target="_blank" class="social-row-link">
        <svg viewBox="0 0 24 24"><path d="M12.525.02c1.31-.02 2.61-.01 3.91-.02.08 1.53.63 3.09 1.75 4.17 1.12 1.11 2.7 1.62 4.24 1.79v4.03c-1.44-.05-2.89-.35-4.2-.97-.57-.26-1.1-.59-1.62-.93-.01 2.92.01 5.84-.02 8.75-.08 1.4-.54 2.79-1.35 3.94-1.31 1.92-3.58 3.17-5.91 3.21-1.43.08-2.86-.31-4.08-1.03-2.02-1.19-3.44-3.37-3.65-5.71-.02-.5-.03-1-.01-1.49.18-1.9 1.12-3.72 2.58-4.96 1.66-1.44 3.98-2.13 6.15-1.72.02 1.48-.04 2.96-.04 4.44-.99-.32-2.15-.23-3.02.37-.63.41-1.11 1.04-1.36 1.75-.21.51-.15 1.07-.14 1.61.24 1.64 1.82 3.02 3.5 2.87 1.12-.01 2.19-.66 2.77-1.61.19-.33.4-.67.41-1.06.1-1.79.06-3.57.07-5.36.01-4.03-.01-8.05.02-12.07z"/></svg>
        <span>TikTok</span>
      </a>
      <a href="mailto:kromapromo@gmail.com" class="social-row-link">
        <svg viewBox="0 0 24 24" fill="currentColor"><path d="M20 4H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"/></svg>
        <span>Contact</span>
      </a>
    </div>
    <!-- Tour Dates -->
    <div class="tour-section">
      <div class="tour-header">
        <div class="section-label" style="justify-content:center"><span style="color:var(--accent-red)">—</span>&nbsp;&nbsp;Live Transmissions&nbsp;&nbsp;<span style="color:var(--accent-red)">—</span><style>.tour-section .section-label::before{display:none}</style></div>
        <h2 class="tour-title">TOUR DATES</h2>
      </div>
      <div class="tour-empty">
        <div class="tour-empty-icon">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1" stroke-linecap="round">
            <circle cx="12" cy="12" r="10"/><path d="M12 6v6l4 2"/>
          </svg>
        </div>
        <div class="tour-empty-text">NO UPCOMING TRANSMISSIONS</div>
        <div class="tour-empty-sub">Signal is charging. Stay tuned for live dates.</div>
        <div class="tour-notify">
          <span class="tour-notify-dot"></span>
          <span>Follow on socials for announcements</span>
        </div>
      </div>
    </div>
  </div>
  <div class="footer"><div class="footer-logo">KROMA</div><div class="footer-copy">© 2026 — ALL SIGNALS RESERVED</div></div>
</section>

<!-- ═══ STORY ═══ -->
<section class="section" id="section-story">
  <div class="story-section">
    <div class="story-welcome">
      <p class="story-welcome-text">Welcome to</p>
      <h1 class="story-welcome-title">SMILEMORE<span style="color:var(--accent-yellow)">.</span></h1>
      <div class="story-divider-glow"></div>
    </div>
    <div class="lore-content">
      <div class="lore-block">
        <div class="lore-chapter">SMILEMORE — SYNOPSIS</div>
        <h3 class="lore-heading">The world has drained into monochrome.</h3>
        <p class="lore-text">In Smilemore, the world has drained into monochrome — a city drowned in psychedelic ink, now muted to black and white. Every citizen wears a <strong>nano-mask</strong> that suppresses emotion, keeping sanity intact while revealing their inner state: <strong style="color:var(--accent-blue)">Lux</strong>, white and good, or <strong style="color:var(--accent-red)">Nox</strong>, black and evil. Nothing remains hidden.</p>
      </div>

      <div class="lore-block">
        <div class="lore-chapter">The City</div>
        <h3 class="lore-heading">A glittering consumerist utopia.</h3>
        <p class="lore-text">The city thrives under <strong>Mayor Happy</strong>, a master of control, in a glittering consumerist utopia where desires are bought, emotions are rented, and everything — happiness, love, rage — can be purchased with money for a fleeting thrill. Yet even in this perfect monotone, some cannot be contained.</p>
      </div>

      <div class="lore-block">
        <div class="lore-chapter">The Flickers</div>
        <h3 class="lore-heading">A sudden short-circuit of the mask.</h3>
        <p class="lore-text">Occasionally, a citizen experiences a <strong>paroxysm</strong> — a flicker — a sudden short-circuit of their mask. In those fleeting moments, they see the world in <strong>selective color</strong> and perceive hidden truths. But the mask is fragile. Remove it entirely and sanity collapses within minutes, leaving only the <strong>Twisted</strong>, spiraling in madness.</p>
      </div>

      <div class="lore-block">
        <div class="lore-chapter">The Protagonist</div>
        <h3 class="lore-heading">A rogue painter. An anarchist. A signal.</h3>
        <p class="lore-text">At the heart of this world is <strong>Kroma</strong>, a rogue painter and anarchist, haunted by a tragedy that stole his memories. Lost in a city of illusions, he searches for the truth. Who stole the color from the world? What really happened to the lost city of <strong>Wondrix</strong>, the place of wonder that once pulsed with emotion?</p>
        <p class="lore-text" style="margin-top:24px;">Through murals of rebellion, hidden messages in graffiti, and daring confrontations with the authorities, Kroma fights to awaken flickers in the people around him and restore the lost spectrum of life.</p>
      </div>

      <div class="lore-block" style="text-align:center;margin-top:60px;">
        <div class="lore-welcome-final">Welcome to Smilemore.</div>
        <button class="explore-city-btn" onclick="openCityMap()">
          <span class="explore-city-icon">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"><path d="M3 7l6-3 6 3 6-3v13l-6 3-6-3-6 3z"/><path d="M9 4v13M15 7v13"/></svg>
          </span>
          <span class="explore-city-text">EXPLORE CITY</span>
        </button>
      </div>
    </div>

    <!-- Gallery Portal -->
    <div class="gallery-portal">
      <div class="gallery-border-top"></div>
      <div class="gallery-icon">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1" stroke-linecap="round" stroke-linejoin="round">
          <rect x="3" y="3" width="18" height="18" rx="2"/>
          <circle cx="8.5" cy="8.5" r="1.5"/>
          <path d="m21 15-5-5L5 21"/>
        </svg>
      </div>
      <div class="gallery-label">The Smilemore Archives</div>
      <h2 class="gallery-title">ENTER THE GALLERY</h2>
      <p class="gallery-desc">Artwork and visual transmissions from the artists who see beyond the monochrome.</p>
      <div class="gallery-grid">
        <div class="gallery-slot" data-num="I" onclick="openLightbox(0)"><img src="gallery-1.png" alt="Freefall" loading="lazy"></div>
        <div class="gallery-slot" data-num="II" onclick="openLightbox(1)"><img src="gallery-2.jpg" alt="The Streets of Smilemore" loading="lazy"></div>
        <div class="gallery-slot" data-num="III" onclick="openLightbox(2)"><img src="gallery-3.jpg" alt="The Vault" loading="lazy"></div>
        <div class="gallery-slot" data-num="IV" onclick="openLightbox(3)"><img src="gallery-4.png" alt="Are You Happy" loading="lazy"></div>
        <div class="gallery-slot" data-num="V" onclick="openLightbox(4)"><img src="gallery-5.jpg" alt="Lux or Nox" loading="lazy"></div>
        <div class="gallery-slot" data-num="VI" onclick="openLightbox(5)"><img src="gallery-6.jpg" alt="Mood Swing" loading="lazy"></div>
      </div>
    </div>

  </div>
  <div class="footer"><div class="footer-logo">KROMA</div><div class="footer-copy">© 2026 — ALL SIGNALS RESERVED</div></div>
</section>


<!-- ═══ MUSIC ═══ -->
<section class="section" id="section-music">
  <div class="music-section">
    <div class="music-header">
      <div class="section-label music-label" style="justify-content:center;color:var(--accent-blue)">Classified Access</div><style>.music-label::before{display:none!important}</style>
      <h2 class="music-title">THE SIGNAL</h2>
      <p class="music-subtitle">Listen to the music. Witness the world unfold.</p>
    </div>

    <div class="cl-track-list">
      <!-- Track 1: FREE -->
      <div class="cl-track" id="clTrack0">
        <div class="cl-track-num">01</div>
        <div class="cl-play" onclick="clToggle(0)">
          <svg class="cl-play-icon" viewBox="0 0 24 24" fill="currentColor"><polygon points="6,3 20,12 6,21"/></svg>
          <svg class="cl-pause-icon" viewBox="0 0 24 24" fill="currentColor"><rect x="5" y="3" width="4" height="18"/><rect x="15" y="3" width="4" height="18"/></svg>
          <div class="cl-play-ring"></div>
        </div>
        <div class="cl-info">
          <div class="cl-title">Smilemore <span class="cl-free-tag">PUBLIC ACCESS</span></div>
          <div class="cl-sub">Kroma Original</div>
          <div class="cl-scrubber" onclick="clScrub(event,0)">
            <div class="cl-scrubber-fill" id="clFill0"><div class="cl-scrubber-head"></div></div>
          </div>
          <div class="cl-time"><span id="clCur0">0:00</span><span id="clDur0">—</span></div>
        </div>
        <div class="cl-waveform" id="clWv0"></div>
        <audio id="clAudio0" preload="auto" src="smile.mp3"></audio>
      </div>

      <!-- Track 2: LOCKED -->
      <div class="cl-track locked" id="clTrack1">
        <div class="cl-track-num">02</div>
        <div class="cl-play" onclick="clToggle(1)">
          <svg class="cl-play-icon" viewBox="0 0 24 24" fill="currentColor"><polygon points="6,3 20,12 6,21"/></svg>
          <svg class="cl-pause-icon" viewBox="0 0 24 24" fill="currentColor"><rect x="5" y="3" width="4" height="18"/><rect x="15" y="3" width="4" height="18"/></svg>
          <div class="cl-play-ring"></div>
        </div>
        <div class="cl-info">
          <div class="cl-title">Vice & Virtue</div>
          <div class="cl-sub">Kroma Original</div>
          <div class="cl-scrubber" onclick="clScrub(event,1)">
            <div class="cl-scrubber-fill" id="clFill1"><div class="cl-scrubber-head"></div></div>
          </div>
          <div class="cl-time"><span id="clCur1">0:00</span><span id="clDur1">—</span></div>
        </div>
        <div class="cl-waveform" id="clWv1"></div>
        <audio id="clAudio1" preload="auto" src="virtue.mp3"></audio>
        <div class="cl-overlay" id="clOverlay1">
          <div class="cl-stamp">
            <div class="cl-stamp-text">CLASSIFIED</div>
            <button class="cl-unlock-btn" onclick="event.stopPropagation();clOpenModal(1)">Enter Access Code</button>
          </div>
        </div>
      </div>

      <!-- Track 3: LOCKED (Lux) -->
      <div class="cl-track locked" id="clTrack2">
        <div class="cl-track-num">03</div>
        <div class="cl-play" onclick="clToggle(2)">
          <svg class="cl-play-icon" viewBox="0 0 24 24" fill="currentColor"><polygon points="6,3 20,12 6,21"/></svg>
          <svg class="cl-pause-icon" viewBox="0 0 24 24" fill="currentColor"><rect x="5" y="3" width="4" height="18"/><rect x="15" y="3" width="4" height="18"/></svg>
          <div class="cl-play-ring"></div>
        </div>
        <div class="cl-info">
          <div class="cl-title">Lux</div>
          <div class="cl-sub">Kroma Original</div>
          <div class="cl-scrubber" onclick="clScrub(event,2)">
            <div class="cl-scrubber-fill" id="clFill2"><div class="cl-scrubber-head"></div></div>
          </div>
          <div class="cl-time"><span id="clCur2">0:00</span><span id="clDur2">—</span></div>
        </div>
        <div class="cl-waveform" id="clWv2"></div>
        <audio id="clAudio2" preload="auto" src="lux.mp3"></audio>
        <div class="cl-overlay" id="clOverlay2">
          <div class="cl-stamp">
            <div class="cl-stamp-text">CLASSIFIED</div>
            <button class="cl-unlock-btn" onclick="event.stopPropagation();clOpenModal(2)">Enter Access Code</button>
          </div>
        </div>
      </div>

      <!-- Track 4: LOCKED (Nox) -->
      <div class="cl-track locked" id="clTrack3">
        <div class="cl-track-num">04</div>
        <div class="cl-play" onclick="clToggle(3)">
          <svg class="cl-play-icon" viewBox="0 0 24 24" fill="currentColor"><polygon points="6,3 20,12 6,21"/></svg>
          <svg class="cl-pause-icon" viewBox="0 0 24 24" fill="currentColor"><rect x="5" y="3" width="4" height="18"/><rect x="15" y="3" width="4" height="18"/></svg>
          <div class="cl-play-ring"></div>
        </div>
        <div class="cl-info">
          <div class="cl-title">Nox</div>
          <div class="cl-sub">Kroma Original</div>
          <div class="cl-scrubber" onclick="clScrub(event,3)">
            <div class="cl-scrubber-fill" id="clFill3"><div class="cl-scrubber-head"></div></div>
          </div>
          <div class="cl-time"><span id="clCur3">0:00</span><span id="clDur3">—</span></div>
        </div>
        <div class="cl-waveform" id="clWv3"></div>
        <audio id="clAudio3" preload="auto" src="nox.mp3"></audio>
        <div class="cl-overlay" id="clOverlay3">
          <div class="cl-stamp">
            <div class="cl-stamp-text">CLASSIFIED</div>
            <button class="cl-unlock-btn" onclick="event.stopPropagation();clOpenModal(3)">Enter Access Code</button>
          </div>
        </div>
      </div>
    </div>

    <div class="music-cta">
      <a href="https://soundcloud.com/iam-kroma/tracks" target="_blank" class="music-cta-link">
        <span>Full Catalog on SoundCloud</span>
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><path d="M5 12h14M12 5l7 7-7 7"/></svg>
      </a>
    </div>

    <!-- Registry Breach Count -->
    <div class="breach-monitor" id="breachMonitor">
      <div class="breach-border"></div>
      <div class="breach-header">
        <div class="breach-indicator"></div>
        <span class="breach-label">SYSTEM MONITOR</span>
        <div class="breach-indicator"></div>
      </div>
      <div class="breach-counter">
        <span class="breach-prefix">REGISTRY BREACH COUNT:</span>
        <span class="breach-value" id="breachValue">0</span>
        <span class="breach-sep">/</span>
        <span class="breach-threshold">50</span>
      </div>
      <div class="breach-bar-track">
        <div class="breach-bar-fill" id="breachBarFill"></div>
        <div class="breach-bar-scanline"></div>
      </div>
      <div class="breach-desc">
        Repeated registry key validations are tracked globally.<br>
        Upon reaching the breach threshold, archive containment will be lifted.
      </div>
      <div class="breach-status" id="breachStatus">STATUS: MONITORING</div>
    </div>

  </div>

  <!-- Code Modal -->
  <div class="cl-modal-bg" id="clModalBg" onclick="clCloseModal()">
    <div class="cl-modal" onclick="event.stopPropagation()">
      <button class="cl-modal-close" onclick="clCloseModal()">✕</button>
      <div class="cl-modal-label">Registry Verification</div>
      <div class="cl-modal-title">ENTER REGISTRY KEY</div>
      <div class="cl-modal-track-name" id="clModalTrack">—</div>
      <input class="cl-code-input" id="clCodeInput" type="text" placeholder="REGISTRY KEY" autocomplete="off" onkeydown="if(event.key==='Enter')clSubmitCode()">
      <button class="cl-submit-btn" onclick="clSubmitCode()">Verify Key</button>
      <div class="cl-feedback" id="clFeedback"></div>
    </div>
  </div>

  <div class="footer"><div class="footer-logo">KROMA</div><div class="footer-copy">© 2026 — ALL SIGNALS RESERVED</div></div>
</section>

</section>

<!-- ═══ STORE ═══ -->
<section class="section" id="section-store">
  <div class="store-coming-soon">
    <div class="store-coming-label">
      <div class="section-label store-label" style="justify-content:center;color:var(--accent-green)">Authorized Merchandise</div>
    </div>
    <h2 class="store-coming-title">COMING SOON</h2>
    <div class="store-coming-divider"></div>
    <p class="store-coming-desc">The Smilemore supply chain is being established.<br>Official merchandise will be available here.</p>

    <div class="store-coming-notify">
      <span class="store-coming-dot"></span>
      <span>Follow for drop announcements</span>
    </div>
  </div>
  <div class="footer"><div class="footer-logo">KROMA</div><div class="footer-copy">© 2026 — ALL SIGNALS RESERVED</div></div>
</section>

<!-- ═══ LUX OR NOX ═══ -->
<section class="section" id="section-luxnox">
  <div class="luxnox-section">
    <div class="luxnox-bg"></div>
    <div class="luxnox-content">
      <p class="luxnox-question">The threshold awaits</p>
      <div class="luxnox-title">
        <span class="luxnox-lux">LUX</span>
        <span class="luxnox-or">or</span>
        <span class="luxnox-nox">NOX</span>
      </div>
      <a href="https://luxornox.com" target="_blank" class="luxnox-enter">
        <span>Enter the System</span>
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><path d="M5 12h14M12 5l7 7-7 7"/></svg>
      </a>
      <p class="luxnox-warning">External transmission — You are leaving KROMA signal range</p>
    </div>
  </div>
</section>

<!-- ═══ CITY MAP MODAL ═══ -->
<div class="city-map-overlay" id="cityMapOverlay">
  <div class="city-map-header">
    <div class="city-map-title-area">
      <div>
        <div class="city-map-label">Archive Cartography</div>
        <div class="city-map-title">SMILEMORE CITY MAP</div>
      </div>
    </div>
    <button class="city-map-close" onclick="closeCityMap()">CLOSE</button>
  </div>

  <div class="city-map-viewport" id="cityMapViewport">
    <div class="city-map-canvas" id="cityMapCanvas">

      <svg class="city-map-bg" viewBox="0 0 1600 1200" fill="none" xmlns="http://www.w3.org/2000/svg">
        <defs>
          <pattern id="cityGrid" width="100" height="100" patternUnits="userSpaceOnUse">
            <path d="M100 0V100H0" stroke="rgba(255,255,255,0.015)" stroke-width="0.5"/>
          </pattern>
        </defs>
        <rect width="1600" height="1200" fill="url(#cityGrid)"/>
        <line x1="800" y1="0" x2="800" y2="1200" stroke="rgba(255,255,255,0.04)" stroke-width="3"/>
        <line x1="0" y1="500" x2="1600" y2="500" stroke="rgba(255,255,255,0.04)" stroke-width="3"/>
        <line x1="400" y1="0" x2="400" y2="1200" stroke="rgba(255,255,255,0.02)" stroke-width="1.5"/>
        <line x1="1200" y1="0" x2="1200" y2="1200" stroke="rgba(255,255,255,0.02)" stroke-width="1.5"/>
        <line x1="0" y1="300" x2="1600" y2="300" stroke="rgba(255,255,255,0.02)" stroke-width="1.5"/>
        <line x1="0" y1="800" x2="1600" y2="800" stroke="rgba(255,255,255,0.02)" stroke-width="1.5"/>
        <ellipse cx="800" cy="520" rx="500" ry="350" stroke="rgba(255,255,255,0.025)" stroke-width="2" stroke-dasharray="8 6"/>
        <!-- Core -->
        <rect x="720" y="420" width="160" height="100" fill="rgba(255,255,255,0.03)" stroke="rgba(255,255,255,0.04)" stroke-width="0.5"/>
        <rect x="740" y="540" width="120" height="60" fill="rgba(255,255,255,0.025)" stroke="rgba(255,255,255,0.035)" stroke-width="0.5"/>
        <!-- Industrial -->
        <rect x="180" y="140" width="200" height="120" fill="rgba(255,255,255,0.02)" stroke="rgba(255,255,255,0.03)" stroke-width="0.5"/>
        <rect x="200" y="160" width="60" height="80" fill="rgba(255,255,255,0.03)"/>
        <rect x="300" y="170" width="50" height="60" fill="rgba(255,255,255,0.025)"/>
        <rect x="220" y="120" width="8" height="40" fill="rgba(255,255,255,0.04)"/>
        <rect x="260" y="110" width="8" height="50" fill="rgba(255,255,255,0.04)"/>
        <rect x="310" y="125" width="8" height="35" fill="rgba(255,255,255,0.04)"/>
        <!-- Freefall tower -->
        <rect x="1180" y="120" width="80" height="180" fill="rgba(255,255,255,0.03)" stroke="rgba(255,255,255,0.04)" stroke-width="0.5"/>
        <rect x="1195" y="100" width="50" height="200" fill="rgba(255,255,255,0.02)"/>
        <line x1="1195" y1="120" x2="1245" y2="120" stroke="rgba(255,255,255,0.03)" stroke-width="0.5"/>
        <line x1="1195" y1="150" x2="1245" y2="150" stroke="rgba(255,255,255,0.03)" stroke-width="0.5"/>
        <line x1="1195" y1="180" x2="1245" y2="180" stroke="rgba(255,255,255,0.03)" stroke-width="0.5"/>
        <line x1="1195" y1="210" x2="1245" y2="210" stroke="rgba(255,255,255,0.03)" stroke-width="0.5"/>
        <line x1="1195" y1="240" x2="1245" y2="240" stroke="rgba(255,255,255,0.03)" stroke-width="0.5"/>
        <line x1="1195" y1="270" x2="1245" y2="270" stroke="rgba(255,255,255,0.03)" stroke-width="0.5"/>
        <!-- Delirium -->
        <rect x="260" y="460" width="140" height="90" fill="rgba(255,255,255,0.02)" stroke="rgba(255,255,255,0.03)" stroke-width="0.5"/>
        <polygon points="330,430 395,460 265,460" fill="rgba(255,255,255,0.015)"/>
        <!-- Wondrix ruins -->
        <rect x="100" y="780" width="180" height="130" fill="rgba(255,255,255,0.012)" stroke="rgba(255,255,255,0.02)" stroke-width="0.5" stroke-dasharray="4 4"/>
        <rect x="120" y="810" width="40" height="50" fill="rgba(255,255,255,0.015)"/>
        <rect x="180" y="800" width="50" height="40" fill="rgba(255,255,255,0.01)"/>
        <circle cx="220" cy="870" r="15" fill="rgba(255,255,255,0.01)" stroke="rgba(255,255,255,0.02)" stroke-width="0.5"/>
        <!-- Ghostwater -->
        <rect x="720" y="980" width="100" height="70" fill="rgba(255,255,255,0.02)" stroke="rgba(255,255,255,0.03)" stroke-width="0.5"/>
        <!-- Scatter -->
        <rect x="550" y="350" width="40" height="30" fill="rgba(255,255,255,0.02)"/>
        <rect x="950" y="380" width="50" height="35" fill="rgba(255,255,255,0.02)"/>
        <rect x="600" y="650" width="35" height="45" fill="rgba(255,255,255,0.018)"/>
        <rect x="1000" y="600" width="45" height="30" fill="rgba(255,255,255,0.018)"/>
        <rect x="480" y="550" width="30" height="25" fill="rgba(255,255,255,0.015)"/>
        <rect x="1100" y="480" width="35" height="40" fill="rgba(255,255,255,0.015)"/>
        <rect x="900" y="700" width="40" height="25" fill="rgba(255,255,255,0.015)"/>
        <rect x="650" y="280" width="25" height="35" fill="rgba(255,255,255,0.015)"/>
        <rect x="1050" y="320" width="30" height="30" fill="rgba(255,255,255,0.015)"/>
      </svg>

      <div class="city-fog city-fog-1"></div>
      <div class="city-fog city-fog-2"></div>

      <div class="city-smoke" style="left:200px;top:80px;">
        <div class="city-smoke-puff" style="width:50px;height:50px;left:0;top:0;background:rgba(180,60,200,0.12);"></div>
        <div class="city-smoke-puff" style="width:40px;height:40px;left:30px;top:-10px;background:rgba(60,180,220,0.1);animation-delay:2s;"></div>
        <div class="city-smoke-puff" style="width:35px;height:35px;left:60px;top:5px;background:rgba(220,100,60,0.08);animation-delay:4s;"></div>
      </div>

      <div class="city-prism-glow" style="left:740px;top:985px;"></div>
      <div class="city-barrier" style="left:80px;top:760px;width:220px;height:170px;"></div>

      <div class="city-loc" data-loc="townhall" style="left:775px;top:440px;" onclick="selectLoc(this)">
        <div class="city-loc-marker"><div class="city-loc-dot"><div class="city-loc-ping"></div></div><div class="city-loc-name">TOWNHALL</div></div>
      </div>
      <div class="city-loc" data-loc="billboard" style="left:780px;top:555px;" onclick="selectLoc(this)">
        <div class="city-loc-marker"><div class="city-loc-dot"><div class="city-loc-ping"></div></div><div class="city-loc-name">WELCOME BILLBOARD</div></div>
      </div>
      <div class="city-loc" data-loc="ruinbow" style="left:260px;top:170px;" onclick="selectLoc(this)">
        <div class="city-loc-marker"><div class="city-loc-dot"><div class="city-loc-ping"></div></div><div class="city-loc-name">RUINBOW</div></div>
      </div>
      <div class="city-loc loc-freefall" data-loc="freefall" style="left:1200px;top:180px;" onclick="selectLoc(this)">
        <div class="city-loc-marker"><div class="city-loc-dot"><div class="city-loc-ping"></div></div><div class="city-loc-name">FREEFALL</div></div>
      </div>
      <div class="city-loc" data-loc="delirium" style="left:310px;top:480px;" onclick="selectLoc(this)">
        <div class="city-loc-marker"><div class="city-loc-dot"><div class="city-loc-ping"></div></div><div class="city-loc-name">THE DELIRIUM</div></div>
      </div>
      <div class="city-loc" data-loc="wondrix" style="left:170px;top:830px;" onclick="selectLoc(this)">
        <div class="city-loc-marker"><div class="city-loc-dot"><div class="city-loc-ping"></div></div><div class="city-loc-name">WONDRIX</div></div>
      </div>
      <div class="city-loc loc-ghostwater" data-loc="ghostwater" style="left:750px;top:1000px;" onclick="selectLoc(this)">
        <div class="city-loc-marker"><div class="city-loc-dot"><div class="city-loc-ping"></div></div><div class="city-loc-name">GHOSTWATER</div></div>
      </div>
    </div>

    <div class="city-zoom">
      <button onclick="cityZoom(1)">+</button>
      <button onclick="cityZoom(-1)">−</button>
    </div>
    <div class="city-info" id="cityInfo">
      <div class="city-info-zone" id="cityInfoZone"></div>
      <div class="city-info-name" id="cityInfoName"></div>
      <div class="city-info-desc" id="cityInfoDesc"></div>
    </div>
  </div>
</div>

<script>
// ═══════════════════════════════════════════════════
// KROMA — FULL IMMERSION ENGINE
// ═══════════════════════════════════════════════════

let currentSection = 'landing';
let audioEnabled = false;
let audioCtx = null;
let sectionSounds = {};
let currentDrone = null;
let masterGain = null;

// ─── Frequency Visualizer Bars ───


// ─── Particles ───
(function createParticles() {
  const c = document.getElementById('particles');
  for (let i = 0; i < 35; i++) {
    const p = document.createElement('div');
    p.className = 'particle';
    p.style.left = Math.random()*100+'%';
    p.style.animationDuration = (15+Math.random()*25)+'s';
    p.style.animationDelay = Math.random()*20+'s';
    const s = (1+Math.random()*2)+'px';
    p.style.width = s; p.style.height = s;
    p.style.opacity = 0.04+Math.random()*0.12;
    c.appendChild(p);
  }
})();

// ─── Custom Cursor ───
const cursorDot = document.getElementById('cursorDot');
const cursorRing = document.getElementById('cursorRing');
let mx=0,my=0,rx=0,ry=0;
document.addEventListener('mousemove',e=>{
  mx=e.clientX;my=e.clientY;
  cursorDot.style.left=mx-3+'px';cursorDot.style.top=my-3+'px';
});
(function animCursor(){
  rx+=(mx-rx)*0.12;ry+=(my-ry)*0.12;
  cursorRing.style.left=rx+'px';cursorRing.style.top=ry+'px';
  requestAnimationFrame(animCursor);
})();
document.querySelectorAll('a,button,.product-card,.lore-image-slot').forEach(el=>{
  el.addEventListener('mouseenter',()=>cursorRing.classList.add('hovering'));
  el.addEventListener('mouseleave',()=>cursorRing.classList.remove('hovering'));
});

// ─── Nav Scroll ───
window.addEventListener('scroll',()=>{
  document.getElementById('nav').classList.toggle('scrolled',window.scrollY>60);
});

// ═══════════════════════════════════════════════════
// AUDIO ENGINE — Per-Section Sound Design
// ═══════════════════════════════════════════════════

function initAudio() {
  audioCtx = new (window.AudioContext || window.webkitAudioContext)();
  masterGain = audioCtx.createGain();
  masterGain.gain.value = 0;
  
  // Compressor for clean output
  const comp = audioCtx.createDynamicsCompressor();
  comp.threshold.value = -24;
  comp.ratio.value = 4;
  masterGain.connect(comp);
  comp.connect(audioCtx.destination);
}

// ═══════════════════════════════════════════════════
// CINEMATIC MUSIC ENGINE — Real musical compositions
// ═══════════════════════════════════════════════════

class MusicEngine {
  constructor(ctx, dest) {
    this.ctx = ctx;
    this.dest = dest;
    this.nodes = [];
    this.intervals = [];
    this.stopped = false;
  }

  osc(type, freq) {
    const o = this.ctx.createOscillator();
    o.type = type; o.frequency.value = freq;
    this.nodes.push(o);
    return o;
  }

  gain(val) {
    const g = this.ctx.createGain();
    g.gain.value = val;
    return g;
  }

  filter(type, freq, q) {
    const f = this.ctx.createBiquadFilter();
    f.type = type; f.frequency.value = freq; if(q) f.Q.value = q;
    return f;
  }

  // Play a note with attack/release envelope
  playNote(freq, startTime, duration, vol, type, filterFreq, dest) {
    if (this.stopped) return;
    const ctx = this.ctx;
    const o = ctx.createOscillator();
    o.type = type || 'sine';
    o.frequency.value = freq;

    const g = ctx.createGain();
    const attack = Math.min(duration * 0.15, 0.3);
    const release = Math.min(duration * 0.4, 1.5);
    g.gain.setValueAtTime(0, startTime);
    g.gain.linearRampToValueAtTime(vol, startTime + attack);
    g.gain.setValueAtTime(vol, startTime + duration - release);
    g.gain.linearRampToValueAtTime(0, startTime + duration);

    if (filterFreq) {
      const f = ctx.createBiquadFilter();
      f.type = 'lowpass'; f.frequency.value = filterFreq; f.Q.value = 0.7;
      o.connect(f); f.connect(g);
    } else {
      o.connect(g);
    }
    g.connect(dest || this.dest);

    o.start(startTime);
    o.stop(startTime + duration + 0.1);
  }

  // Play chord
  playChord(freqs, startTime, duration, vol, type, filterFreq, dest) {
    freqs.forEach(f => this.playNote(f, startTime, duration, vol, type, filterFreq, dest));
  }

  stop() {
    this.stopped = true;
    this.intervals.forEach(id => clearInterval(id));
    this.intervals = [];
    this.nodes.forEach(n => { try { n.stop(); } catch(e){} });
    this.nodes = [];
  }

  loop(fn, intervalSec) {
    fn();
    const id = setInterval(() => { if (!this.stopped) fn(); }, intervalSec * 1000);
    this.intervals.push(id);
  }
}

// ── Note frequencies ──
const N = {
  C2:65.41, D2:73.42, Eb2:77.78, E2:82.41, F2:87.31, G2:98, Ab2:103.83, A2:110, Bb2:116.54, B2:123.47,
  C3:130.81, D3:146.83, Eb3:155.56, E3:164.81, F3:174.61, G3:196, Ab3:207.65, A3:220, Bb3:233.08, B3:246.94,
  C4:261.63, D4:293.66, Eb4:311.13, E4:329.63, F4:349.23, G4:392, Ab4:415.30, A4:440, Bb4:466.16, B4:493.88,
  C5:523.25, D5:587.33, Eb5:622.25, E5:659.26, G5:783.99
};

function createSectionMusic(section) {
  const ctx = audioCtx;
  const eng = new MusicEngine(ctx, masterGain);

  // Reverb-like effect using delays
  const reverbG = ctx.createGain(); reverbG.gain.value = 0.3;
  const del1 = ctx.createDelay(); del1.delayTime.value = 0.12;
  const del2 = ctx.createDelay(); del2.delayTime.value = 0.24;
  const del3 = ctx.createDelay(); del3.delayTime.value = 0.37;
  const dg1 = ctx.createGain(); dg1.gain.value = 0.25;
  const dg2 = ctx.createGain(); dg2.gain.value = 0.15;
  const dg3 = ctx.createGain(); dg3.gain.value = 0.08;
  const lpf = ctx.createBiquadFilter(); lpf.type='lowpass'; lpf.frequency.value=2000;

  reverbG.connect(del1); del1.connect(dg1); dg1.connect(lpf);
  reverbG.connect(del2); del2.connect(dg2); dg2.connect(lpf);
  reverbG.connect(del3); del3.connect(dg3); dg3.connect(lpf);
  lpf.connect(masterGain);

  const dry = ctx.createGain(); dry.gain.value = 0.7;
  dry.connect(masterGain);
  const wet = reverbG;

  if (section === 'landing') {
    // ── ORIGIN: Cinematic dark ambient with slow piano-like arpeggios ──
    // Key: Cm - dark, brooding, cinematic
    const bpm = 50;
    const beatLen = 60/bpm;
    const loopLen = beatLen * 16; // 16 beats per loop

    eng.loop(() => {
      const t = ctx.currentTime + 0.05;

      // Slow bass movement: C - Ab - Eb - G
      const bassNotes = [N.C2, N.Ab2, N.Eb2, N.G2];
      bassNotes.forEach((note, i) => {
        eng.playNote(note, t + i*beatLen*4, beatLen*4.5, 0.06, 'sine', 120, dry);
        eng.playNote(note*2, t + i*beatLen*4, beatLen*4.5, 0.02, 'triangle', 200, dry);
      });

      // Ethereal pad chords
      const chords = [
        [N.C3, N.Eb3, N.G3, N.C4],        // Cm
        [N.Ab2, N.C3, N.Eb3, N.Ab3],       // Ab
        [N.Eb3, N.G3, N.Bb3, N.Eb4],       // Eb
        [N.G2, N.B2, N.D3, N.G3]           // G (dominant)
      ];
      chords.forEach((chord, i) => {
        eng.playChord(chord, t + i*beatLen*4 + 0.5, beatLen*5, 0.018, 'sine', 400, wet);
      });

      // Slow cinematic melody — high register, sparse
      const melody = [
        {n:N.G4,t:0,d:3}, {n:N.Eb4,t:3.5,d:2}, {n:N.D4,t:6,d:4},
        {n:N.C4,t:11,d:2.5}, {n:N.Eb4,t:14,d:3}
      ];
      melody.forEach(m => {
        eng.playNote(m.n, t + m.t*beatLen, m.d*beatLen, 0.025, 'sine', 800, wet);
      });
    }, loopLen);

  } else if (section === 'luxnox') {
    // ── LUX OR NOX: DARK, SINISTER, DREAD ──
    const bpm = 40;
    const beatLen = 60/bpm;
    const loopLen = beatLen * 16;

    eng.loop(() => {
      const t = ctx.currentTime + 0.05;

      // Sub-bass drone — detuned for beating/unease
      eng.playNote(N.C2, t, loopLen, 0.06, 'sine', 80, dry);
      eng.playNote(65.8, t, loopLen, 0.04, 'sine', 80, dry); // slightly sharp — creates beating

      // Tritone rumble — the devil's interval
      eng.playNote(N.C2, t + beatLen*4, beatLen*8, 0.035, 'sawtooth', 60, dry);
      eng.playNote(92.5, t + beatLen*4, beatLen*8, 0.03, 'sawtooth', 60, dry); // Gb1-ish tritone

      // Dissonant cluster chords — slow, suffocating
      const dreadChords = [
        [N.C3, N.Eb3, N.B3],              // minor-major tension
        [N.B2, N.D3, N.Ab3],              // diminished horror
        [N.Bb2, N.Eb3, N.A3],             // tritone stack
        [N.Ab2, N.D3, N.G3]               // augmented dread
      ];
      dreadChords.forEach((chord, i) => {
        eng.playChord(chord, t + i*beatLen*4 + 0.3, beatLen*5, 0.012, 'sawtooth', 250, wet);
      });

      // Ghostly high tones — sparse, icy
      const whispers = [
        {n:N.B4,t:2,d:6}, {n:N.Ab4,t:9,d:4}, {n:N.Eb5,t:14,d:3}
      ];
      whispers.forEach(w => {
        eng.playNote(w.n, t + w.t*beatLen, w.d*beatLen, 0.008, 'sine', 2000, wet);
      });

      // Heartbeat-like sub pulse — irregular, menacing
      const pulses = [0, 0.6, 4, 4.6, 8.5, 9.1, 12, 12.6];
      pulses.forEach(p => {
        eng.playNote(N.C2, t + p*beatLen, beatLen*0.3, 0.07, 'sine', 50, dry);
      });

      // Metallic scrapes — very quiet, unsettling texture
      const scrapes = [3, 7, 11, 15];
      scrapes.forEach(s => {
        eng.playNote(N.E5, t + s*beatLen, beatLen*0.08, 0.004, 'sawtooth', 4000, wet);
      });
    }, loopLen);

  } else if (section === 'music') {
    // ── MUSIC: Ambient pulse — stays out of the way of actual tracks ──
    const bpm = 60;
    const beatLen = 60/bpm;
    const loopLen = beatLen * 16;

    eng.loop(() => {
      const t = ctx.currentTime + 0.05;
      // Very subtle low drone only — doesn't compete with SoundCloud players
      const bassNotes = [N.C2, N.G2, N.A2, N.E2];
      bassNotes.forEach((note, i) => {
        eng.playNote(note, t + i*beatLen*4, beatLen*5, 0.025, 'sine', 80, dry);
      });
    }, loopLen);

  } else if (section === 'store') {
    // ── STORE: Clean, minimal, modern — electronic pulse with melody ──
    const bpm = 75;
    const beatLen = 60/bpm;
    const loopLen = beatLen * 16;

    eng.loop(() => {
      const t = ctx.currentTime + 0.05;

      // Tight bass pulse
      const bassPattern = [N.E2,0,0,N.E2, 0,N.E2,0,0, N.A2,0,0,N.A2, 0,N.G2,0,N.G2];
      bassPattern.forEach((note,i) => {
        if(note) eng.playNote(note, t + i*beatLen, beatLen*0.8, 0.05, 'sine', 160, dry);
      });

      // Soft pad — Em feel
      const chords = [
        [N.E3, N.G3, N.B3],
        [N.A3, N.C4, N.E4],
        [N.G3, N.B3, N.D4],
        [N.G3, N.B3, N.D4]
      ];
      chords.forEach((chord,i) => {
        eng.playChord(chord, t + i*beatLen*4, beatLen*5, 0.012, 'sine', 600, wet);
      });

      // Plucky arpeggio — gives it movement
      const arp = [N.E4,N.G4,N.B4,N.E5, N.B4,N.G4,N.E4,N.G4,
                   N.A4,N.C5,N.E5,N.C5, N.B4,N.G4,N.D4,N.G4];
      arp.forEach((note,i) => {
        eng.playNote(note, t + i*beatLen, beatLen*0.6, 0.015, 'sine', 1200, wet);
      });
    }, loopLen);

  } else if (section === 'story') {
    // ── STORY: Emotional, haunting, beautiful — cinematic piano-like ──
    const bpm = 55;
    const beatLen = 60/bpm;
    const loopLen = beatLen * 20; // longer loop for more drama

    eng.loop(() => {
      const t = ctx.currentTime + 0.05;

      // Deep sustained bass
      const bassNotes = [{n:N.A2,t:0,d:5}, {n:N.F2,t:5,d:5},
                         {n:N.D2,t:10,d:5}, {n:N.E2,t:15,d:5}];
      bassNotes.forEach(b => {
        eng.playNote(b.n, t + b.t*beatLen, b.d*beatLen, 0.05, 'sine', 130, dry);
      });

      // Am - F - Dm - E progression (emotional, cinematic)
      const chords = [
        [N.A3, N.C4, N.E4],        // Am
        [N.F3, N.A3, N.C4],        // F
        [N.D3, N.F3, N.A3],        // Dm
        [N.E3, N.Ab3, N.B3]        // E (the resolve tension)
      ];
      chords.forEach((chord,i) => {
        eng.playChord(chord, t + i*beatLen*5 + 1, beatLen*6, 0.02, 'sine', 500, wet);
        // Double at octave for richness
        eng.playChord(chord.map(f=>f*2), t + i*beatLen*5 + 1.5, beatLen*5, 0.006, 'triangle', 800, wet);
      });

      // Emotional melody — telling a story
      const melody = [
        {n:N.E4,t:0.5,d:2}, {n:N.A4,t:2.5,d:3}, {n:N.G4,t:5.5,d:1.5},
        {n:N.F4,t:7,d:3}, {n:N.E4,t:10.5,d:2}, {n:N.D4,t:12.5,d:2},
        {n:N.C4,t:14.5,d:1.5}, {n:N.D4,t:16,d:2}, {n:N.E4,t:18,d:3}
      ];
      melody.forEach(m => {
        eng.playNote(m.n, t + m.t*beatLen, m.d*beatLen, 0.028, 'sine', 1000, wet);
      });

      // Counter-melody — sparse high notes
      const counter = [
        {n:N.C5,t:3,d:3}, {n:N.A4,t:8,d:2}, {n:N.F4,t:13,d:2.5}, {n:N.E5,t:17,d:3}
      ];
      counter.forEach(m => {
        eng.playNote(m.n, t + m.t*beatLen, m.d*beatLen, 0.012, 'sine', 1400, wet);
      });
    }, loopLen);
  }

  return eng;
}

function startSectionSound(section) {
  if (!audioCtx || !audioEnabled) return;

  // Instant kill old sound
  if (currentDrone) {
    try {
      currentDrone.gain.gain.cancelScheduledValues(audioCtx.currentTime);
      currentDrone.gain.gain.setValueAtTime(0, audioCtx.currentTime);
      currentDrone.engine.stop();
    } catch(e) {}
    currentDrone = null;
  }

  const g = audioCtx.createGain();
  g.gain.value = 1; // instant full volume
  g.connect(masterGain);

  const engine = createSectionMusic(section);
  currentDrone = { gain: g, engine };
}



function toggleAudio() {
  const btn = document.getElementById('audioToggle');
  if (!audioCtx) initAudio();
  
  audioEnabled = !audioEnabled;
  btn.classList.toggle('muted', !audioEnabled);
  
  if (audioEnabled) {
    audioCtx.resume();
    masterGain.gain.linearRampToValueAtTime(1, audioCtx.currentTime + 1.5);
    startSectionSound(currentSection);
    btn.querySelector('.audio-label').textContent = 'Sound On';
  } else {
    masterGain.gain.linearRampToValueAtTime(0, audioCtx.currentTime + 1);
    btn.querySelector('.audio-label').textContent = 'Enable Sound';
  }
}

function playNavSound() {
  if (!audioCtx || !audioEnabled) return;
  const o = audioCtx.createOscillator();
  const g = audioCtx.createGain();
  o.type='sine'; o.frequency.value=600;
  o.frequency.exponentialRampToValueAtTime(200, audioCtx.currentTime+0.4);
  g.gain.value=0.04;
  g.gain.exponentialRampToValueAtTime(0.001, audioCtx.currentTime+0.4);
  o.connect(g); g.connect(masterGain);
  o.start(); o.stop(audioCtx.currentTime+0.4);
}

function playHoverSound() {
  if (!audioCtx || !audioEnabled) return;
  const o = audioCtx.createOscillator();
  const g = audioCtx.createGain();
  o.type='sine'; o.frequency.value=900;
  g.gain.value=0.012;
  g.gain.exponentialRampToValueAtTime(0.001, audioCtx.currentTime+0.12);
  o.connect(g); g.connect(masterGain);
  o.start(); o.stop(audioCtx.currentTime+0.12);
}

document.querySelectorAll('.nav-link,.social-link,.product-btn,.luxnox-enter').forEach(el=>{
  el.addEventListener('mouseenter', playHoverSound);
});

// ─── Navigation ───
function navigateTo(sectionName) {
  if (sectionName === currentSection) return;
  
  const transition = document.getElementById('pageTransition');
  transition.classList.add('active');
  if (audioEnabled) playNavSound();
  
  setTimeout(() => {
    document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
    const target = document.getElementById('section-' + sectionName);
    if (target) { target.classList.add('active'); window.scrollTo(0,0); }
    
    document.querySelectorAll('.nav-link').forEach(link => {
      link.classList.toggle('active', link.dataset.section === sectionName);
    });
    
    currentSection = sectionName;
    startSectionSound(sectionName);
    
    if (sectionName === 'story') {
      triggerInkEffect();
      setTimeout(observeLoreBlocks, 300);
    }
  }, 250);
  
  setTimeout(() => transition.classList.remove('active'), 550);
}

// ─── Ink Effect ───
let inkAnimId = null;
function triggerInkEffect() {
  if (inkAnimId) { cancelAnimationFrame(inkAnimId); inkAnimId = null; }
  const canvas = document.getElementById('inkCanvas');
  if (!canvas) return;
  const ctx = canvas.getContext('2d');
  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight;
  canvas.classList.add('active');
  ctx.fillStyle = '#000';
  ctx.fillRect(0, 0, canvas.width, canvas.height);
  const w = canvas.width, h = canvas.height;
  let circles = [];
  for (let i = 0; i < 35; i++) {
    circles.push({
      x: Math.random()*w, y: Math.random()*h,
      r: 0, maxR: 150+Math.random()*400, speed: 4+Math.random()*6,
      delay: Math.random()*15
    });
  }
  [[0,0],[w,0],[0,h],[w,h],[w/2,h/2]].forEach(p => {
    circles.push({ x:p[0], y:p[1], r:0, maxR:Math.max(w,h)*0.6, speed:8, delay:5+Math.random()*5 });
  });
  let frame = 0;
  function anim() {
    frame++;
    ctx.globalCompositeOperation = 'destination-out';
    let allDone = true;
    circles.forEach(c => {
      if (frame > c.delay && c.r < c.maxR) {
        c.r += c.speed;
        ctx.beginPath(); ctx.arc(c.x, c.y, c.r, 0, Math.PI*2); ctx.fill();
        allDone = false;
      }
    });
    if (frame < 120 && !allDone) {
      inkAnimId = requestAnimationFrame(anim);
    } else {
      canvas.classList.remove('active');
      ctx.clearRect(0, 0, w, h);
      inkAnimId = null;
    }
  }
  inkAnimId = requestAnimationFrame(anim);
}
function observeLoreBlocks() {
  const obs = new IntersectionObserver(entries => {
    entries.forEach(e => { if(e.isIntersecting) e.target.classList.add('visible'); });
  }, {threshold:0.15});
  document.querySelectorAll('.lore-block').forEach(b => obs.observe(b));
}

// ─── Parallax ───
document.addEventListener('mousemove', e => {
  if (currentSection !== 'landing') return;
  const px = (e.clientX/window.innerWidth - 0.5)*2;
  const py = (e.clientY/window.innerHeight - 0.5)*2;
  const hc = document.querySelector('.hero-content');
  if(hc) hc.style.transform = `translate(${px*-8}px,${py*-5}px)`;
  const grid = document.querySelector('.hero-grid');
  if(grid) grid.style.transform = `translate(${px*15}px,${py*10}px)`;
});

// ─── Audio bar animation ───
(function animBars() {
  if (audioEnabled) {
    document.querySelectorAll('.audio-toggle .audio-bar').forEach(bar => {
      bar.style.height = (3+Math.random()*14)+'px';
    });
  }
  requestAnimationFrame(animBars);
})();

// Initial lore observer
setTimeout(observeLoreBlocks, 500);

window.addEventListener('resize', () => {
  const c = document.getElementById('inkCanvas');
  c.width = window.innerWidth; c.height = window.innerHeight;
});





// ═══════════════════════════════════════════════════
// CLASSIFIED ACCESS — Music Player Engine
// ═══════════════════════════════════════════════════

// ── CHANGE THESE CODES ──
const CODE_1 = 'VV-VERDICT-7Q2';    // Unlock Vice & Virtue
const CODE_2 = 'NX-UMBRA-4KF';      // Unlock Nox
const CODE_3 = 'LX-LUMEN-8DP';      // Unlock Lux
// ─────────────────────────

const CL_CODES = { 1: CODE_1, 2: CODE_3, 3: CODE_2 };
const CL_KEYS = { 1: 'unlockedVirtue', 2: 'unlockedLux', 3: 'unlockedNox' };
const CL_NAMES = { 1: 'SIGNAL-002 // REDACTED', 2: 'SIGNAL-003 // REDACTED', 3: 'SIGNAL-004 // REDACTED' };
const CL_COUNT = 4;
let clPlaying = -1;
let clModalTarget = -1;

// Init waveforms
for (let t = 0; t < CL_COUNT; t++) {
  const wv = document.getElementById('clWv' + t);
  if (!wv) continue;
  for (let i = 0; i < 100; i++) {
    const b = document.createElement('div');
    b.className = 'cl-wv';
    b.style.height = '0';
    wv.appendChild(b);
  }
}

// Animate waveforms
function clAnimWv() {
  for (let t = 0; t < CL_COUNT; t++) {
    const wv = document.getElementById('clWv' + t);
    if (!wv) continue;
    const bars = wv.children;
    if (t === clPlaying) {
      const now = Date.now() * 0.002;
      for (let i = 0; i < bars.length; i++) {
        const x = i / bars.length;
        const v = (Math.sin(x*8+now)*0.5+0.5) + (Math.sin(x*12-now*1.3)*0.3) + (Math.sin(x*4+now*0.7)*0.2);
        bars[i].style.height = (v * 70 + Math.random() * 4) + '%';
      }
    } else {
      for (let i = 0; i < bars.length; i++) bars[i].style.height = '0';
    }
  }
  requestAnimationFrame(clAnimWv);
}
clAnimWv();

// Restore unlocked state from localStorage
function clRestoreUnlocks() {
  for (let id = 1; id <= 3; id++) {
    try {
      if (localStorage.getItem(CL_KEYS[id]) === 'true') {
        clUnlockTrack(id, false);
      }
    } catch(e) {}
  }
}

// ── BREACH COUNTER — FIREBASE GLOBAL ──
const BREACH_THRESHOLD = 50;

// Firebase init
const firebaseConfig = {
  apiKey: "AIzaSyBYjFvuTNUjj2HxahXjYozTguimyMUvaxY",
  authDomain: "kroma-breach.firebaseapp.com",
  databaseURL: "https://kroma-breach-default-rtdb.firebaseio.com",
  projectId: "kroma-breach",
  storageBucket: "kroma-breach.firebasestorage.app",
  messagingSenderId: "326548665068",
  appId: "1:326548665068:web:6fc66628494917da3babc9"
};
firebase.initializeApp(firebaseConfig);
const breachRef = firebase.database().ref('breachCount');

let currentBreachCount = 0;

// Listen for real-time updates from all users
breachRef.on('value', (snapshot) => {
  const val = snapshot.val();
  currentBreachCount = (typeof val === 'number') ? val : 0;
  updateBreachUI(currentBreachCount);
});

function isTrackCounted(id) {
  try { return localStorage.getItem('breachCounted_' + id) === 'true'; } catch(e) { return false; }
}
function markTrackCounted(id) {
  try { localStorage.setItem('breachCounted_' + id, 'true'); } catch(e) {}
}

function updateBreachUI(count) {
  const el = document.getElementById('breachValue');
  const bar = document.getElementById('breachBarFill');
  const status = document.getElementById('breachStatus');
  if (el) el.textContent = count;
  if (bar) bar.style.width = Math.min(100, (count / BREACH_THRESHOLD) * 100) + '%';
  if (count >= BREACH_THRESHOLD) {
    if (status) {
      status.textContent = 'ARCHIVE RELEASED — STATUS: PUBLIC ACCESS';
      status.classList.add('released');
    }
    // Unlock all tracks permanently
    for (let id = 1; id <= 3; id++) {
      clUnlockTrack(id, false);
    }
  }
}

function breachIncrement(trackId) {
  if (isTrackCounted(trackId)) return; // no duplicates per user
  markTrackCounted(trackId);
  // Atomic increment via Firebase transaction
  breachRef.transaction((current) => {
    return (current || 0) + 1;
  });
  // Animate counter pulse
  const el = document.getElementById('breachValue');
  if (el) {
    el.classList.add('pulse');
    setTimeout(() => el.classList.remove('pulse'), 600);
  }
}

function clUnlockTrack(id, animate) {
  const overlay = document.getElementById('clOverlay' + id);
  const card = document.getElementById('clTrack' + id);

  if (animate && overlay && !overlay.classList.contains('unlocked')) {
    // Cinematic clearance animation
    overlay.classList.add('clearing');
    if (card) card.classList.add('clearance-pulse');

    setTimeout(() => {
      overlay.classList.add('unlocked');
      if (card) {
        card.classList.remove('locked', 'clearance-pulse');
        const info = card.querySelector('.cl-info');
        const play = card.querySelector('.cl-play');
        const num = card.querySelector('.cl-track-num');
        if (info) { info.style.opacity = '1'; info.style.pointerEvents = 'auto'; }
        if (play) { play.style.opacity = '1'; play.style.pointerEvents = 'auto'; }
        if (num) { num.style.opacity = ''; }
      }
    }, 1200);
  } else {
    // Instant unlock (restore from localStorage)
    if (overlay) overlay.classList.add('unlocked');
    if (card) {
      card.classList.remove('locked');
      const info = card.querySelector('.cl-info');
      const play = card.querySelector('.cl-play');
      const num = card.querySelector('.cl-track-num');
      if (info) { info.style.opacity = '1'; info.style.pointerEvents = 'auto'; }
      if (play) { play.style.opacity = '1'; play.style.pointerEvents = 'auto'; }
      if (num) { num.style.opacity = ''; }
    }
  }

  try { localStorage.setItem(CL_KEYS[id], 'true'); } catch(e) {}
}

// Audio time update
for (let i = 0; i < CL_COUNT; i++) {
  const au = document.getElementById('clAudio' + i);
  if (!au) continue;
  au.addEventListener('timeupdate', () => {
    if (!au.duration) return;
    const pct = (au.currentTime / au.duration) * 100;
    const fill = document.getElementById('clFill' + i);
    if (fill) fill.style.width = pct + '%';
    document.getElementById('clCur' + i).textContent = clFmt(au.currentTime);
    document.getElementById('clDur' + i).textContent = clFmt(au.duration);
  });
  au.addEventListener('loadedmetadata', () => {
    document.getElementById('clDur' + i).textContent = clFmt(au.duration);
  });
  au.addEventListener('ended', () => {
    const card = document.getElementById('clTrack' + i);
    if (card) card.classList.remove('playing');
    clPlaying = -1;
  });
}

function clFmt(s) {
  const m = Math.floor(s / 60);
  const sec = Math.floor(s % 60);
  return m + ':' + (sec < 10 ? '0' : '') + sec;
}

function clToggle(idx) {
  // Check if locked
  if (idx >= 1) {
    const overlay = document.getElementById('clOverlay' + idx);
    if (overlay && !overlay.classList.contains('unlocked')) return;
  }

  const au = document.getElementById('clAudio' + idx);
  if (!au) return;

  if (clPlaying === idx) {
    au.pause();
    document.getElementById('clTrack' + idx).classList.remove('playing');
    clPlaying = -1;
  } else {
    // Stop current
    if (clPlaying >= 0) {
      const prev = document.getElementById('clAudio' + clPlaying);
      if (prev) prev.pause();
      document.getElementById('clTrack' + clPlaying).classList.remove('playing');
    }
    au.play().catch(e => console.log('Play blocked:', e));
    document.getElementById('clTrack' + idx).classList.add('playing');
    clPlaying = idx;
  }
}

function clScrub(e, idx) {
  e.stopPropagation();
  if (idx >= 1) {
    const overlay = document.getElementById('clOverlay' + idx);
    if (overlay && !overlay.classList.contains('unlocked')) return;
  }
  const au = document.getElementById('clAudio' + idx);
  if (!au || !au.duration) return;
  const bar = e.currentTarget;
  const rect = bar.getBoundingClientRect();
  const pct = Math.max(0, Math.min(1, (e.clientX - rect.left) / rect.width));
  au.currentTime = pct * au.duration;
  if (clPlaying !== idx) clToggle(idx);
}

// Modal
function clOpenModal(id) {
  clModalTarget = id;
  document.getElementById('clModalTrack').textContent = CL_NAMES[id];
  document.getElementById('clCodeInput').value = '';
  document.getElementById('clCodeInput').className = 'cl-code-input';
  document.getElementById('clFeedback').textContent = '';
  document.getElementById('clFeedback').className = 'cl-feedback';
  document.getElementById('clModalBg').classList.add('open');
  setTimeout(() => document.getElementById('clCodeInput').focus(), 100);
}

function clCloseModal() {
  document.getElementById('clModalBg').classList.remove('open');
  clModalTarget = -1;
}

function clSubmitCode() {
  const input = document.getElementById('clCodeInput');
  const fb = document.getElementById('clFeedback');
  const code = input.value.trim().toUpperCase();
  const expected = CL_CODES[clModalTarget];

  if (!expected) return;

  if (code === expected.toUpperCase()) {
    input.className = 'cl-code-input granted';
    fb.className = 'cl-feedback granted';
    fb.textContent = 'CLEARANCE ACCEPTED';
    clUnlockTrack(clModalTarget, true);
    breachIncrement(clModalTarget);
    setTimeout(clCloseModal, 1400);
  } else {
    input.className = 'cl-code-input denied';
    fb.className = 'cl-feedback denied';
    fb.textContent = 'INVALID REGISTRY KEY';
    setTimeout(() => {
      input.className = 'cl-code-input';
      fb.textContent = '';
    }, 1500);
  }
}

// Restore on load
clRestoreUnlocks();


// ═══════════════════════════════════════════════════
// SMILEMORE CITY MAP — Interactive
// ═══════════════════════════════════════════════════

const CITY_LOCS = {
  townhall: {
    zone: 'Core Zone',
    name: 'TOWNHALL',
    desc: 'Mask issuance & VEIL registration center. Every citizen receives their nano-mask here. The bureaucratic heart of Smilemore.',
    color: ''
  },
  billboard: {
    zone: 'Core Zone',
    name: 'WELCOME BILLBOARD',
    desc: 'City propaganda structure. Its message never changes. A towering display visible from every district, reminding citizens to comply.',
    color: ''
  },
  ruinbow: {
    zone: 'Industrial Zone',
    name: 'RUINBOW',
    desc: 'Chemical factory producing artificial emotions. Pumps colored smoke into Smilemore\'s atmosphere. The only visible color in the city skyline.',
    color: ''
  },
  freefall: {
    zone: 'Restricted Zone',
    name: 'FREEFALL',
    desc: 'Vertical containment prison. Those who remove their masks are sent here. No one has ever returned from the upper floors.',
    color: 'red'
  },
  delirium: {
    zone: 'Commercial District',
    name: 'THE DELIRIUM',
    desc: 'Wandering\'s Emporium of gizmos and gadgets. A strange marketplace where impossible objects are traded. Nothing is quite what it seems.',
    color: ''
  },
  wondrix: {
    zone: 'Exclusion Zone',
    name: 'WONDRIX',
    desc: 'The old city. Off-limits. Roped off and forbidden. An atompunk ruin where color once existed freely. They say the walls still remember.',
    color: ''
  },
  ghostwater: {
    zone: 'Distant Safe Zone',
    name: 'GHOSTWATER',
    desc: 'Remote safe house. Contains prism anomaly. The only structure where color persists. A refuge for those who remember what the world looked like.',
    color: ''
  }
};

let cityScale = 0.5;
let cityX = 0, cityY = 0;
let cityDragging = false;
let cityDragStart = {x:0, y:0};
let cityPanStart = {x:0, y:0};
let cityPinchDist = 0;
let activeLoc = null;

function openCityMap() {
  const overlay = document.getElementById('cityMapOverlay');
  overlay.classList.add('open');
  document.body.style.overflow = 'hidden';
  // Center map
  const vp = document.getElementById('cityMapViewport');
  cityScale = Math.min(vp.clientWidth / 1600, vp.clientHeight / 1200) * 1.2;
  cityX = (vp.clientWidth - 1600 * cityScale) / 2;
  cityY = (vp.clientHeight - 1200 * cityScale) / 2;
  updateCityTransform();
}

function closeCityMap() {
  document.getElementById('cityMapOverlay').classList.remove('open');
  document.body.style.overflow = '';
  deselectLoc();
}

function updateCityTransform() {
  const canvas = document.getElementById('cityMapCanvas');
  canvas.style.transform = 'translate(' + cityX + 'px,' + cityY + 'px) scale(' + cityScale + ')';
}

function cityZoom(dir) {
  const vp = document.getElementById('cityMapViewport');
  const cx = vp.clientWidth / 2;
  const cy = vp.clientHeight / 2;
  const oldScale = cityScale;
  cityScale = Math.max(0.25, Math.min(2.5, cityScale + dir * 0.15));
  const ratio = cityScale / oldScale;
  cityX = cx - (cx - cityX) * ratio;
  cityY = cy - (cy - cityY) * ratio;
  updateCityTransform();
}

// Mouse/touch handlers
const vp = document.getElementById('cityMapViewport');
if (vp) {
  vp.addEventListener('pointerdown', (e) => {
    if (e.target.closest('.city-loc') || e.target.closest('.city-zoom')) return;
    cityDragging = true;
    cityDragStart = { x: e.clientX, y: e.clientY };
    cityPanStart = { x: cityX, y: cityY };
    vp.setPointerCapture(e.pointerId);
  });
  vp.addEventListener('pointermove', (e) => {
    if (!cityDragging) return;
    cityX = cityPanStart.x + (e.clientX - cityDragStart.x);
    cityY = cityPanStart.y + (e.clientY - cityDragStart.y);
    updateCityTransform();
  });
  vp.addEventListener('pointerup', () => { cityDragging = false; });
  vp.addEventListener('pointercancel', () => { cityDragging = false; });

  // Wheel zoom
  vp.addEventListener('wheel', (e) => {
    e.preventDefault();
    const dir = e.deltaY < 0 ? 1 : -1;
    const oldScale = cityScale;
    cityScale = Math.max(0.25, Math.min(2.5, cityScale + dir * 0.1));
    const ratio = cityScale / oldScale;
    const rect = vp.getBoundingClientRect();
    const mx = e.clientX - rect.left;
    const my = e.clientY - rect.top;
    cityX = mx - (mx - cityX) * ratio;
    cityY = my - (my - cityY) * ratio;
    updateCityTransform();
  }, { passive: false });

  // Touch pinch zoom
  let touches = {};
  vp.addEventListener('touchstart', (e) => {
    for (const t of e.changedTouches) touches[t.identifier] = t;
    if (Object.keys(touches).length === 2) {
      const ids = Object.keys(touches);
      const t1 = touches[ids[0]], t2 = touches[ids[1]];
      cityPinchDist = Math.hypot(t1.clientX - t2.clientX, t1.clientY - t2.clientY);
    }
  }, { passive: true });
  vp.addEventListener('touchmove', (e) => {
    for (const t of e.changedTouches) touches[t.identifier] = t;
    const ids = Object.keys(touches);
    if (ids.length === 2) {
      const t1 = touches[ids[0]], t2 = touches[ids[1]];
      const dist = Math.hypot(t1.clientX - t2.clientX, t1.clientY - t2.clientY);
      if (cityPinchDist > 0) {
        const delta = dist / cityPinchDist;
        const oldScale = cityScale;
        cityScale = Math.max(0.25, Math.min(2.5, cityScale * delta));
        const ratio = cityScale / oldScale;
        const rect = vp.getBoundingClientRect();
        const mx = (t1.clientX + t2.clientX) / 2 - rect.left;
        const my = (t1.clientY + t2.clientY) / 2 - rect.top;
        cityX = mx - (mx - cityX) * ratio;
        cityY = my - (my - cityY) * ratio;
        updateCityTransform();
      }
      cityPinchDist = dist;
    }
  }, { passive: true });
  vp.addEventListener('touchend', (e) => {
    for (const t of e.changedTouches) delete touches[t.identifier];
    if (Object.keys(touches).length < 2) cityPinchDist = 0;
  }, { passive: true });

  // Click on viewport background to deselect
  vp.addEventListener('click', (e) => {
    if (!e.target.closest('.city-loc') && !e.target.closest('.city-zoom') && !e.target.closest('.city-info')) {
      deselectLoc();
    }
  });
}

function selectLoc(el) {
  const loc = el.dataset.loc;
  const data = CITY_LOCS[loc];
  if (!data) return;

  // Deselect previous
  document.querySelectorAll('.city-loc.active').forEach(l => l.classList.remove('active'));
  el.classList.add('active');
  activeLoc = loc;

  const info = document.getElementById('cityInfo');
  document.getElementById('cityInfoZone').textContent = data.zone;
  const nameEl = document.getElementById('cityInfoName');
  nameEl.textContent = data.name;
  nameEl.className = 'city-info-name' + (data.color === 'red' ? ' red' : '');
  document.getElementById('cityInfoDesc').textContent = data.desc;
  info.classList.add('visible');
}

function deselectLoc() {
  document.querySelectorAll('.city-loc.active').forEach(l => l.classList.remove('active'));
  document.getElementById('cityInfo').classList.remove('visible');
  activeLoc = null;
}


// ═══ GALLERY LIGHTBOX ═══
const galleryImages = [
  { src:'gallery-1.png', caption:'Archive I — Freefall' },
  { src:'gallery-2.jpg', caption:'Archive II — The Streets of Smilemore' },
  { src:'gallery-3.jpg', caption:'Archive III — The Vault' },
  { src:'gallery-4.png', caption:'Archive IV — Are You Happy' },
  { src:'gallery-5.jpg', caption:'Archive V — Lux or Nox' },
  { src:'gallery-6.jpg', caption:'Archive VI — Mood Swing' }
];
let lightboxIdx = 0;

function openLightbox(idx) {
  lightboxIdx = idx;
  const lb = document.getElementById('galleryLightbox');
  const img = document.getElementById('lightboxImg');
  const cap = document.getElementById('lightboxCaption');
  img.src = galleryImages[idx].src;
  cap.textContent = galleryImages[idx].caption;
  lb.classList.add('open');
  document.body.style.overflow = 'hidden';
}

function closeLightbox() {
  document.getElementById('galleryLightbox').classList.remove('open');
  document.body.style.overflow = '';
}

function lightboxNav(dir) {
  lightboxIdx = (lightboxIdx + dir + galleryImages.length) % galleryImages.length;
  document.getElementById('lightboxImg').src = galleryImages[lightboxIdx].src;
  document.getElementById('lightboxCaption').textContent = galleryImages[lightboxIdx].caption;
}

// Keyboard nav
document.addEventListener('keydown', (e) => {
  const lb = document.getElementById('galleryLightbox');
  if (!lb.classList.contains('open')) return;
  if (e.key === 'Escape') closeLightbox();
  if (e.key === 'ArrowLeft') lightboxNav(-1);
  if (e.key === 'ArrowRight') lightboxNav(1);
});


</script>

<!-- Gallery Lightbox -->
<div class="gallery-lightbox" id="galleryLightbox" onclick="closeLightbox()">
  <button class="gallery-lightbox-close" onclick="closeLightbox()">CLOSE</button>
  <button class="gallery-lightbox-nav prev" onclick="event.stopPropagation();lightboxNav(-1)">‹</button>
  <button class="gallery-lightbox-nav next" onclick="event.stopPropagation();lightboxNav(1)">›</button>
  <img id="lightboxImg" src="" alt="" onclick="event.stopPropagation()">
  <div class="gallery-lightbox-caption" id="lightboxCaption"></div>
</div>
</body>
</html>
